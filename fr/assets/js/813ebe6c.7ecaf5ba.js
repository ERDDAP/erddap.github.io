"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[5432],{28453(e,n,t){t.d(n,{R:()=>o,x:()=>d});var i=t(96540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},37483(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"server-admin/mqtt-integration","title":"ERDDAP Int\xe9gration MQTT","description":"ERDDAP le protocole MQTT pour faciliter l\'ingestion de donn\xe9es en temps r\xe9el et les notifications. Cette fonctionnalit\xe9 est aliment\xe9e par le open-source  Client HiveMQ MQTT  et  \xc9dition communautaire HiveMQ  des biblioth\xe8ques de courtage.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/server-admin/mqtt-integration.md","sourceDirName":"server-admin","slug":"/server-admin/mqtt-integration","permalink":"/fr/docs/server-admin/mqtt-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/erddap/erddap.github.io/tree/main/docs/server-admin/mqtt-integration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docSidebar","previous":{"title":"Options","permalink":"/fr/docs/server-admin/feature-flags"},"next":{"title":"Contributing","permalink":"/fr/docs/category/contributing"}}');var r=t(74848),s=t(28453);const o={},d="ERDDAP Int\xe9gration MQTT",c={},a=[{value:"ERDDAP en tant que client MQTT",id:"erddap-en-tant-que-client-mqtt",level:2},{value:"Configuration &amp; #160;: <code>EDDTableFromMqtt</code>",id:"configuration--160-eddtablefrommqtt",level:2},{value:"ERDDAP comme courtier MQTT",id:"erddap-comme-courtier-mqtt",level:2},{value:"Permettre au courtier int\xe9gr\xe9",id:"permettre-au-courtier-int\xe9gr\xe9",level:2},{value:"Configuration des courtiers et r\xe9pertoires de donn\xe9es",id:"configuration-des-courtiers-et-r\xe9pertoires-de-donn\xe9es",level:2},{value:"Cas d&#39;utilisation 1 : ing\xe9rer les donn\xe9es des clients du MQTT",id:"cas-dutilisation-1--ing\xe9rer-les-donn\xe9es-des-clients-du-mqtt",level:2},{value:"Cas d&#39;utilisation 2 : Publication des notifications de modification des ensembles de donn\xe9es",id:"cas-dutilisation-2--publication-des-notifications-de-modification-des-ensembles-de-donn\xe9es",level:2},{value:"Parsing variable environnement dans <code>datasets.xml</code>",id:"parsing-variable-environnement-dans-datasetsxml",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"erddap-int\xe9gration-mqtt",children:"ERDDAP Int\xe9gration MQTT"})}),"\n",(0,r.jsxs)(n.p,{children:["ERDDAP le protocole MQTT pour faciliter l'ingestion de donn\xe9es en temps r\xe9el et les notifications. Cette fonctionnalit\xe9 est aliment\xe9e par le open-source ",(0,r.jsxs)(n.a,{href:"https://github.com/hivemq/hivemq-mqtt-client",children:[" ",(0,r.jsx)(n.strong,{children:"Client HiveMQ MQTT"})," "]})," et ",(0,r.jsxs)(n.a,{href:"https://github.com/hivemq/hivemq-community-edition",children:[" ",(0,r.jsx)(n.strong,{children:"\xc9dition communautaire HiveMQ"})," "]})," des biblioth\xe8ques de courtage."]}),"\n",(0,r.jsx)(n.p,{children:"ERDDAP peut tirer parti de MQTT de deux fa\xe7ons principales :"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"En tant que client MQTT :"}),"    ERDDAP peuvent s'abonner \xe0 des sujets sur un courtier MQTT existant pour ing\xe9rer des donn\xe9es et cr\xe9er des ensembles de donn\xe9es en temps r\xe9el."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"En tant que courtier MQTT :"}),"    ERDDAP peut h\xe9berger son propre courtier MQTT int\xe9gr\xe9, permettant aux clients externes de lui publier des donn\xe9es directement."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Oui."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"erddap-en-tant-que-client-mqtt",children:"ERDDAP en tant que client MQTT"}),"\n",(0,r.jsxs)(n.p,{children:["ERDDAP peut agir comme client MQTT pour s'abonner \xe0 des sujets sur un courtier MQTT externe ou son propre courtier int\xe9gr\xe9. Ceci est r\xe9alis\xe9 en utilisant la nouvelle ",(0,r.jsx)(n.code,{children:"EDDTableFromMqtt"})," type d'ensemble de donn\xe9es, qui fonctionne de la m\xeame mani\xe8re que l'actuel ",(0,r.jsxs)(n.a,{href:"/docs/server-admin/datasets#eddtablefromhttpget",children:[" ",(0,r.jsx)(n.code,{children:"EDDTableFromHttpGet"})," "]})," ensemble de donn\xe9es."]}),"\n",(0,r.jsxs)(n.p,{children:["Actuellement, la mise en \u0153uvre du client ne prend en charge que ",(0,r.jsx)(n.strong,{children:"abonnement"})," \xe0 des sujets."]}),"\n",(0,r.jsxs)(n.h2,{id:"configuration--160-eddtablefrommqtt",children:["Configuration & #160;: ",(0,r.jsx)(n.code,{children:"EDDTableFromMqtt"})]}),"\n",(0,r.jsxs)(n.p,{children:["Pour configurer un ensemble de donn\xe9es pour s'abonner \xe0 un courtier MQTT, d\xe9finissez un ensemble de donn\xe9es de type ",(0,r.jsx)(n.code,{children:"EDDTableFromMqtt"})," dans votre ",(0,r.jsx)(n.code,{children:"datasets.xml"})," fichier. Les balises de configuration suivantes sont disponibles dans la ",(0,r.jsx)(n.code,{children:"<dataset>"})," bloc:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\x3c!-- Example configuration for an EDDTableFromMqtt dataset in datasets.xml --\x3e\n<dataset type=\"EDDTableFromMqtt\" datasetID=\"mqtt_realtime_data\" active=\"true\">\n\n    \x3c!-- The hostname or IP address of the MQTT broker. --\x3e\n    <serverHost>broker.example.com</serverHost>\n\n    \x3c!-- The port number of the MQTT broker. --\x3e\n    <serverPort>1883</serverPort>\n\n    \x3c!-- A unique identifier for this MQTT client. --\x3e\n    <clientId>erddap-subscriber-1</clientId>\n\n    \x3c!-- The username for broker authentication (optional). --\x3e\n    <username>user</username>\n\n    \x3c!-- The password for broker authentication (optional). --\x3e\n    <password>secret</password>\n\n    \x3c!-- A comma-separated list of MQTT topics to subscribe to. --\x3e\n    <topics>sensor/+/data, another/topic</topics>\n\n    \x3c!-- Set to 'true' to use a secure SSL/TLS connection. Default is 'false'. --\x3e\n    <useSsl>false</useSsl>\n\n    \x3c!-- The session expiry interval in seconds. --\x3e\n    <sessionExpiryInterval>3600</sessionExpiryInterval>\n\n    \x3c!-- The connection timeout in seconds. --\x3e\n    <connectionTimeout>10</connectionTimeout>\n\n    \x3c!-- Set to 'true' to enable automatic reconnection. Default is 'true'. --\x3e\n    <automaticReconnect>true</automaticReconnect>\n\n</dataset>\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Oui."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"erddap-comme-courtier-mqtt",children:"ERDDAP comme courtier MQTT"}),"\n",(0,r.jsx)(n.p,{children:"ERDDAP peut g\xe9rer un courtier MQTT int\xe9gr\xe9, qui a deux objectifs principaux:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Ingestion des donn\xe9es:"})," Pour recevoir des donn\xe9es publi\xe9es par des clients externes du MQTT pour cr\xe9er des ensembles de donn\xe9es en temps r\xe9el."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Notifications:"})," Publier des notifications sur les modifications de l'ensemble de donn\xe9es."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"permettre-au-courtier-int\xe9gr\xe9",children:"Permettre au courtier int\xe9gr\xe9"}),"\n",(0,r.jsxs)(n.p,{children:["Le courtier MQTT int\xe9gr\xe9 est d\xe9sactiv\xe9 par d\xe9faut. Pour l'activer, ajouter le drapeau suivant \xe0 ",(0,r.jsx)(n.code,{children:"configuration.xml"})," :"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"\x3c!-- Enables the embedded HiveMQ broker. Default is 'false'. --\x3e   <enableMqttBroker> vrai </enableMqttBroker>"})}),"\n",(0,r.jsx)(n.h2,{id:"configuration-des-courtiers-et-r\xe9pertoires-de-donn\xe9es",children:"Configuration des courtiers et r\xe9pertoires de donn\xe9es"}),"\n",(0,r.jsxs)(n.p,{children:["Vous pouvez sp\xe9cifier des r\xe9pertoires personnalis\xe9s pour la configuration du courtier et les fichiers de donn\xe9es dans ",(0,r.jsx)(n.code,{children:"configuration.xml"})," . Si ces \xe9tiquettes sont laiss\xe9es vides, ERDDAP utilisera les r\xe9pertoires par d\xe9faut sp\xe9cifi\xe9s par la biblioth\xe8que HiveMQ. Pour des d\xe9tails de configuration plus avanc\xe9s, y compris l'enregistrement et les extensions, veuillez consulter le ",(0,r.jsxs)(n.a,{href:"https://github.com/hivemq/hivemq-community-edition/wiki",children:[" ",(0,r.jsx)(n.strong,{children:"HiveMQ Community Edition Wiki"})," "]})," ."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\x3c!-- The parent directory for all MQTT-related files. --\x3e\n<bigParentDirectory>/opt/erddap/mqtt/</bigParentDirectory>\n\n\x3c!-- The path to the embedded MQTT broker's configuration folder. --\x3e\n<mqttConfigFolder>/opt/erddap/mqtt/conf/</mqttConfigFolder>\n\n\x3c!-- The path to the embedded MQTT broker's data folder. --\x3e\n<mqttDataFolder>/opt/erddap/mqtt/data/</mqttDataFolder>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"cas-dutilisation-1--ing\xe9rer-les-donn\xe9es-des-clients-du-mqtt",children:"Cas d'utilisation 1 : ing\xe9rer les donn\xe9es des clients du MQTT"}),"\n",(0,r.jsxs)(n.p,{children:["Pour construire un ensemble de donn\xe9es en temps r\xe9el en utilisant le courtier int\xe9gr\xe9, vous pouvez configurer un ",(0,r.jsx)(n.code,{children:"EDDTableFromMqtt"})," ensemble de donn\xe9es (comme d\xe9crit ci-dessus) dans le ",(0,r.jsx)(n.em,{children:"m\xeame"})," ERDDAP instance pour se connecter \xe0 son propre courtier local . Les clients externes du MQTT peuvent ensuite publier des donn\xe9es \xe0 ERDDAP courtier, dont le ",(0,r.jsx)(n.code,{children:"EDDTableFromMqtt"})," dataset s'abonnera et ing\xe9rera."]}),"\n",(0,r.jsx)(n.h2,{id:"cas-dutilisation-2--publication-des-notifications-de-modification-des-ensembles-de-donn\xe9es",children:"Cas d'utilisation 2 : Publication des notifications de modification des ensembles de donn\xe9es"}),"\n",(0,r.jsxs)(n.p,{children:["ERDDAP peut \xeatre configur\xe9 pour publier des notifications sur les modifications des ensembles de donn\xe9es (Par exemple, mises \xe0 jour ou recharges) \xe0 un sujet sur un courtier MQTT. Tout d'abord, assurez-vous que le courtier est activ\xe9 ou qu'un courtier externe est disponible. Puis, activez la fonctionnalit\xe9 de notification dans ",(0,r.jsx)(n.code,{children:"configuration.xml"})," :"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"\x3c!-- Set to 'true' to publish dataset change notifications via MQTT. Default is 'false'. --\x3e   <publishMqttNotif> vrai </publishMqttNotif>"})}),"\n",(0,r.jsxs)(n.p,{children:["Lorsque cette fonctionnalit\xe9 est activ\xe9e, ERDDAP utilise un client MQTT interne pour publier les messages. Les param\xe8tres de connexion pour ce client peuvent \xeatre personnalis\xe9s dans ",(0,r.jsx)(n.code,{children:"configuration.xml"})," . Le tableau ci-dessous \xe9num\xe8re les param\xe8tres disponibles et leurs valeurs par d\xe9faut."]}),"\n",(0,r.jsxs)(n.p,{children:["| Balise | Type | Valeur par d\xe9faut | D\xe9signation des marchandises |\n| ------------ | - Oui. | ----------------- | ------------------------------------------------------------------------ |\n|   ",(0,r.jsx)(n.code,{children:"<mqttServerHost>"}),"           | cha\xeene |   ",(0,r.jsx)(n.code,{children:"h\xf4te local"}),"         | Le courtier h\xf4te de publier des notifications \xe0. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttServerPort>"}),"           | Int |   ",(0,r.jsx)(n.code,{children:"1883"}),"              | Le port du courtier en notification. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttClientId>"}),"             | cha\xeene |   ",(0,r.jsx)(n.code,{children:"Client erddap"}),"     | L'identit\xe9 du client pour l'\xe9diteur de notification. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttUserName>"}),"             | cha\xeene |   ",(0,r.jsx)(n.code,{children:"erddap-nom d'utilisateur"}),"   | Le nom d'utilisateur de l'\xe9diteur de notification. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttPassword>"}),"             | cha\xeene |   ",(0,r.jsx)(n.code,{children:"Mot de passe erddap"}),"   | Le mot de passe de l'\xe9diteur de notification. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttSsl>"}),"                  | bool\xe9en |   ",(0,r.jsx)(n.code,{children:"faux"}),"             | Utilisez SSL/TLS pour la connexion de notification. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttKeepAlive>"}),"            | Int |   ",(0,r.jsx)(n.code,{children:"60"}),"                | Maintenir l'intervalle de vie en quelques secondes. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttCleanStart>"}),"           | bool\xe9en |   ",(0,r.jsx)(n.code,{children:"faux"}),"             | Commencez par une session propre (aucun \xe9tat de session persistant) . |\n|   ",(0,r.jsx)(n.code,{children:"<mqttSessionExpiry>"}),"        | Int |   ",(0,r.jsx)(n.code,{children:"10"}),"                | Intervalle d'expiration de la session en secondes. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttConnectionTimeout>"}),"    | Int |   ",(0,r.jsx)(n.code,{children:"10"}),"                | D\xe9lai de connexion en secondes. |\n|   ",(0,r.jsx)(n.code,{children:"<mqttAutomaticReconnect>"}),"   | bool\xe9en |   ",(0,r.jsx)(n.code,{children:"vrai"}),"              | Reconnecter automatiquement si la connexion est perdue. |"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Oui."}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"parsing-variable-environnement-dans-datasetsxml",children:["Parsing variable environnement dans ",(0,r.jsx)(n.code,{children:"datasets.xml"})]}),"\n",(0,r.jsxs)(n.p,{children:["Une nouvelle fonctionnalit\xe9 a \xe9t\xe9 introduite qui permet l'utilisation de variables d'environnement dans ",(0,r.jsx)(n.code,{children:"datasets.xml"})," . Voici ",(0,r.jsx)(n.strong,{children:"activ\xe9 par d\xe9faut"})," ."]}),"\n",(0,r.jsxs)(n.p,{children:["Pour d\xe9sactiver cette fonctionnalit\xe9, ajoutez le drapeau suivant \xe0 ",(0,r.jsx)(n.code,{children:"configuration.xml"})," :"]}),"\n",(0,r.jsx)(n.p,{children:"xml"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"<enableEnvParsing> faux </enableEnvParsing>"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}}}]);