"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[6889],{28453:(e,a,n)=>{n.d(a,{R:()=>s,x:()=>d});var t=n(96540);const o={},r=t.createContext(o);function s(e){const a=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:a},e.children)}},52276:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>i,contentTitle:()=>d,default:()=>c,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"server-admin/prometheus","title":"Prometheus","description":"Prometheovy metriky jsou k dispozici v /erddap/metrics. JVM j\xe1dro metriky byly p\u0159id\xe1ny v 2.25 s mnoha ERDDAP\u2122 metriky p\u0159idan\xe9 ve verzi 2.26. Pokud chcete pou\u017e\xedt metriky, ujist\u011bte se, \u017ee jste alespo\u0148 ve verzi 2.26. Oni v\xfdchoz\xed povolit, m\u016f\u017eete je zak\xe1zat p\u0159id\xe1n\xedm","source":"@site/i18n/cs/docusaurus-plugin-content-docs/current/server-admin/prometheus.md","sourceDirName":"server-admin","slug":"/server-admin/prometheus","permalink":"/cs/docs/server-admin/prometheus","draft":false,"unlisted":false,"editUrl":"https://github.com/erddap/erddap.github.io/tree/main/docs/server-admin/prometheus.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"docSidebar","previous":{"title":"Lok\xe1ln\xed metadata","permalink":"/cs/docs/server-admin/localized-metadata"},"next":{"title":"Vlajky funkc\xed","permalink":"/cs/docs/server-admin/feature-flags"}}');var o=n(74848),r=n(28453);const s={sidebar_position:9},d="Prometheus",i={},l=[{value:"Spu\u0161t\u011bn\xed serveru Prometheus",id:"spu\u0161t\u011bn\xed-serveru-prometheus",level:2},{value:"ERDDAP\u2122 metriky",id:"erddap-metriky",level:2},{value:"JVM",id:"jvm",level:3},{value:"ERDDAP\u2122 specifick\xe9",id:"erddap-specifick\xe9",level:3},{value:"ERDDAP _build_info",id:"erddap-_build_info",level:4},{value:"feature_flags",id:"feature_flags",level:4},{value:"pufrovan\xe9 Obr\xe1zek",id:"pufrovan\xe9-obr\xe1zek",level:4},{value:"http _request_durace_sekundy",id:"http-_request_durace_sekundy",level:4},{value:"touch_thread_durace_sekundy",id:"touch_thread_durace_sekundy",level:4},{value:"\xfakol_vazba_durace_sekundy",id:"\xfakol_vazba_durace_sekundy",level:4},{value:"load_datasets_durace_sekund",id:"load_datasets_durace_sekund",level:4},{value:"email_thread_durace_sekundy",id:"email_thread_durace_sekundy",level:4},{value:"email_count_distribution",id:"email_count_distribution",level:4},{value:"Datab\xe1ze_count",id:"datab\xe1ze_count",level:4},{value:"Database_failed_load_count",id:"database_failed_load_count",level:4},{value:"bouda_po\u017eadavky_celkem",id:"bouda_po\u017eadavky_celkem",level:4},{value:"nebezpe\u010dn\xe9_pam\u011b\u0165_emaily_celkem",id:"nebezpe\u010dn\xe9_pam\u011b\u0165_emaily_celkem",level:4},{value:"nebezpe\u010dn\xe9_pam\u011b\u0165_selh\xe1n\xed_celkem",id:"nebezpe\u010dn\xe9_pam\u011b\u0165_selh\xe1n\xed_celkem",level:4},{value:"topo_request_total",id:"topo_request_total",level:4},{value:"Hranice",id:"hranice",level:4}];function u(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.header,{children:(0,o.jsx)(a.h1,{id:"prometheus",children:"Prometheus"})}),"\n",(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.a,{href:"https://prometheus.io/",children:"Prometheovy metriky"})," jsou k dispozici v /erddap/metrics. JVM j\xe1dro metriky byly p\u0159id\xe1ny v 2.25 s mnoha ERDDAP\u2122 metriky p\u0159idan\xe9 ve verzi 2.26. Pokud chcete pou\u017e\xedt metriky, ujist\u011bte se, \u017ee jste alespo\u0148 ve verzi 2.26. Oni v\xfdchoz\xed povolit, m\u016f\u017eete je zak\xe1zat p\u0159id\xe1n\xedm"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-xml",children:"<usePrometheusMetrics>false</usePrometheusMetrics>\n"})}),"\n",(0,o.jsx)(a.p,{children:"na va\u0161e nastaven\xed.xml."}),"\n",(0,o.jsx)(a.p,{children:"Tyto metriky jsou navr\u017eeny tak, aby byly strojov\u011b \u010diteln\xe9. Zat\xedmco m\u016f\u017eete ru\u010dn\u011b zkontrolovat str\xe1nku metriky, pro hloubkov\xfd monitoring se doporu\u010duje pou\u017e\xedt server Prometheus. Prometheus server bude ukl\xe1dat historick\xe9 metriky, kter\xe9 umo\u017e\u0148uj\xed v\xedce do hloubky monitorov\xe1n\xed (jako sazby a zm\u011bny z minul\xfdch hodnot) , a tak\xe9 je \u010dasto spu\u0161t\u011bn se serverem Grafana. Poskytujeme n\u011bkter\xe9 p\u0159edem postaven\xe9 palubn\xed desky, kter\xe9 mohou b\xfdt u\u017eite\u010dn\xe9 pro zah\xe1jen\xed monitorov\xe1n\xed sv\xfdch server\u016f."}),"\n",(0,o.jsx)(a.h2,{id:"spu\u0161t\u011bn\xed-serveru-prometheus",children:"Spu\u0161t\u011bn\xed serveru Prometheus"}),"\n",(0,o.jsxs)(a.p,{children:["Nejlep\u0161\xed dokumentace pro spu\u0161t\u011bn\xed monitorovac\xedho z\xe1sobn\xedku (Prometheus + Grafana) je v Prometheu ",(0,o.jsx)(a.a,{href:"https://github.com/ERDDAP/erddap/blob/main/docker/prometheus/README.md",children:"readme"})," ."]}),"\n",(0,o.jsx)(a.h2,{id:"erddap-metriky",children:"ERDDAP\u2122 metriky"}),"\n",(0,o.jsx)(a.h3,{id:"jvm",children:"JVM"}),"\n",(0,o.jsxs)(a.p,{children:["ERDDAP\u2122 exportuje \u0159adu metrik, kter\xe9 m\u016f\u017eete naj\xedt u\u017eite\u010dn\xe9 (za\u010d\xedn\xe1me ERDDAP\u2122 2. 25) . Pro obecn\xe9 sledov\xe1n\xed zdrav\xed JVM pou\u017e\xedv\xe1me metriky shrom\xe1\u017ed\u011bn\xe9 klientem Prometheus. To zahrnuje data o sb\u011bru odpadk\u016f, vyu\u017eit\xed pam\u011bti, nit\u011b a dal\u0161\xed. V\xedce informac\xed viz ",(0,o.jsx)(a.a,{href:"https://prometheus.github.io/client_java/instrumentation/jvm/",children:"Prometheus Java Klientsk\xe1 dokumentace JVM"})," ."]}),"\n",(0,o.jsx)(a.h3,{id:"erddap-specifick\xe9",children:"ERDDAP\u2122 specifick\xe9"}),"\n",(0,o.jsxs)(a.p,{children:["Tak\xe9 jsme exportovat \u0159adu ERDDAP\u2122 specifick\xe9 metriky (za\u010d\xedn\xe1me ERDDAP\u2122 2. 26) . Pokud chcete kopat do k\xf3du, m\u016f\u017eete naj\xedt metriky shrom\xe1\u017ed\u011bn\xe9 v ",(0,o.jsx)(a.a,{href:"https://github.com/ERDDAP/erddap/blob/main/WEB-INF/classes/gov/noaa/pfel/erddap/util/Metrics.java",children:"Metrics.java"})," ."]}),"\n",(0,o.jsx)(a.h4,{id:"erddap-_build_info",children:"ERDDAP _build_info"}),"\n",(0,o.jsx)(a.p,{children:"Tohle je informace o stavb\u011b ERDDAP\u2122 server. Obsahuje verzi (major. men\u0161\xed) , verze_pln\xe1 (major. minor.patch) , a nasazen\xed_info (slou\u017e\xed k ozna\u010den\xed, jak je server nasazen, jako 'Docker ') ."}),"\n",(0,o.jsx)(a.h4,{id:"feature_flags",children:"feature_flags"}),"\n",(0,o.jsx)(a.p,{children:"Jedn\xe1 se o informa\u010dn\xed metriku, kter\xe1 ukazuje aktu\xe1ln\xed stav vlajek funkc\xed. V\u011bt\u0161ina boole\xe1nsk\xfdch konfigurac\xed jsou pova\u017eov\xe1ny za funkce vlajky."}),"\n",(0,o.jsx)(a.h4,{id:"pufrovan\xe9-obr\xe1zek",children:"pufrovan\xe9 Obr\xe1zek"}),"\n",(0,o.jsx)(a.p,{children:"Jedn\xe1 se o informa\u010dn\xed metriku, kter\xe1 ud\xe1v\xe1, zda je k dispozici grafick\xe9 zrychlen\xed."}),"\n",(0,o.jsx)(a.h4,{id:"http-_request_durace_sekundy",children:"http _request_durace_sekundy"}),"\n",(0,o.jsx)(a.p,{children:"Tohle je histogram doby odezvy na \u017e\xe1dost v sekund\xe1ch. \u0160t\xedtky jsou request_type (nap\u0159\xedklad griddap, tabledap , soubory, wms) , database_id (p\u0159\xedpadn\u011b jinak opakuje typ \u017e\xe1dosti) , soubor_typ (v\xfdstupn\xed form\xe1t pro \u017e\xe1dost nap\u0159. '.html', '.csv', '.iso19115 ') , lang_k\xf3d (jazyk \u017e\xe1dosti nebo pr\xe1zdn\xfd \u0159et\u011bzec, pokud je v\xfdchoz\xed) , status_code ( http stavov\xfd k\xf3d \u017e\xe1dosti, nap\u0159. 200, 302, 404) ."}),"\n",(0,o.jsx)(a.p,{children:"To lze pou\u017e\xedt pro sledov\xe1n\xed po\u017eadavk\u016f pomoc\xed souboru dat k ur\u010den\xed popul\xe1rn\xedch soubor\u016f serveru. M\u016f\u017ee tak\xe9 pomoci ur\u010dit, zda existuj\xed ur\u010dit\xe9 druhy po\u017eadavk\u016f, kter\xe9 jsou pomal\xe9 na va\u0161em serveru."}),"\n",(0,o.jsx)(a.h4,{id:"touch_thread_durace_sekundy",children:"touch_thread_durace_sekundy"}),"\n",(0,o.jsx)(a.p,{children:"Histogram dotekov\xfdch vl\xe1ken trv\xe1n\xed \xfakolu. Jsou ozna\u010deny \xfasp\u011bchem (true/false) ."}),"\n",(0,o.jsx)(a.h4,{id:"\xfakol_vazba_durace_sekundy",children:"\xfakol_vazba_durace_sekundy"}),"\n",(0,o.jsx)(a.p,{children:"Histogram trv\xe1n\xed \xfalohov\xfdch nit\xed. Jsou ozna\u010deny \xfasp\u011bchem (true/false) a typ \xfalohy_typ (intetger) ."}),"\n",(0,o.jsx)(a.h4,{id:"load_datasets_durace_sekund",children:"load_datasets_durace_sekund"}),"\n",(0,o.jsx)(a.p,{children:"Histogram doby trv\xe1n\xed pro \xfalohy datov\xe9ho souboru zat\xed\u017een\xed. Jsou ozna\u010deny velk\xfdm p\xedsmem. (true/false) ."}),"\n",(0,o.jsx)(a.h4,{id:"email_thread_durace_sekundy",children:"email_thread_durace_sekundy"}),"\n",(0,o.jsx)(a.p,{children:"Histogram e-mailov\xfdch vl\xe1ken trv\xe1n\xed \xfakolu. Jsou ozna\u010deny \xfasp\u011bchem (true/false) ."}),"\n",(0,o.jsx)(a.h4,{id:"email_count_distribution",children:"email_count_distribution"}),"\n",(0,o.jsx)(a.p,{children:"Histogram e-mail\u016f na jeden \xfakol."}),"\n",(0,o.jsx)(a.h4,{id:"datab\xe1ze_count",children:"Datab\xe1ze_count"}),"\n",(0,o.jsx)(a.p,{children:"M\u011b\u0159\xedtko soubor\u016f \xfadaj\u016f, nastaven\xe9 po ka\u017ed\xe9m vol\xe1n\xed soubor\u016f \xfadaj\u016f o zat\xed\u017een\xed. Je ozna\u010dena kategori\xed (m\u0159\xed\u017eka, tabulka) ."}),"\n",(0,o.jsx)(a.h4,{id:"database_failed_load_count",children:"Database_failed_load_count"}),"\n",(0,o.jsx)(a.p,{children:"M\u011b\u0159idlo soubor\u016f \xfadaj\u016f, kter\xe9 se nepoda\u0159ilo na\u010d\xedst, nastaven\xe9 po ka\u017ed\xe9m vol\xe1n\xed soubor\u016f \xfadaj\u016f o zat\xed\u017een\xed."}),"\n",(0,o.jsx)(a.h4,{id:"bouda_po\u017eadavky_celkem",children:"bouda_po\u017eadavky_celkem"}),"\n",(0,o.jsx)(a.p,{children:"Proti po\u017eadavk\u016fm, kter\xe9 byly sta\u017eeny. Server prozrad\xed po\u017eadavek, kdy\u017e se domn\xedv\xe1, \u017ee server je m\xe1lo pam\u011bti (RAM) a \u017e\xe1dost by zp\u016fsobila probl\xe9my. To nezahrnuje po\u017eadavky, \u017ee chyba v d\u016fsledku n\xedzk\xe9 RAM nebo m\xedsta na disku b\u011bhem manipulace s \u017e\xe1dost\xed."}),"\n",(0,o.jsx)(a.h4,{id:"nebezpe\u010dn\xe9_pam\u011b\u0165_emaily_celkem",children:"nebezpe\u010dn\xe9_pam\u011b\u0165_emaily_celkem"}),"\n",(0,o.jsx)(a.p,{children:"Po\u010d\xedtaje \u010das, kdy se server pokou\u0161\xed poslat e-mail spr\xe1vci, \u017ee pam\u011b\u0165 je nebezpe\u010dn\u011b n\xedzk\xe1."}),"\n",(0,o.jsx)(a.h4,{id:"nebezpe\u010dn\xe9_pam\u011b\u0165_selh\xe1n\xed_celkem",children:"nebezpe\u010dn\xe9_pam\u011b\u0165_selh\xe1n\xed_celkem"}),"\n",(0,o.jsx)(a.p,{children:"Po\u010ditadlo \u017e\xe1dost\xed, kter\xe9 selhaly kv\u016fli tomu, \u017ee stroj do\u0161el pam\u011bti. \u010casto je to proto, \u017ee stroj dost\xe1v\xe1 hodn\u011b drah\xe9 \u017e\xe1dosti nebo individu\xe1ln\xed \u017e\xe1dost byla v\xfdjime\u010dn\u011b velk\xe1."}),"\n",(0,o.jsx)(a.h4,{id:"topo_request_total",children:"topo_request_total"}),"\n",(0,o.jsx)(a.p,{children:"Po\u010d\xedtadlo \u017e\xe1dost\xed o topo data. Toto je ozna\u010den\xe1 cache. (cached/not_catched) ."}),"\n",(0,o.jsx)(a.h4,{id:"hranice",children:"Hranice"}),"\n",(0,o.jsx)(a.p,{children:"Je tu tak\xe9 sb\xedrka \u010d\xedta\u010d\u016f pro \u017e\xe1dosti o hranice:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"n\xe1rodn\xed_hrani\u010d\xed_request_total"}),"\n",(0,o.jsx)(a.li,{children:"st\xe1t_hrani\u010d\xed_request_total"}),"\n",(0,o.jsx)(a.li,{children:"\u0159eka_hrani\u010d\xed_request_total"}),"\n",(0,o.jsx)(a.li,{children:"gshhs_request_total"}),"\n"]}),"\n",(0,o.jsx)(a.p,{children:"Jsou ozna\u010deny statusem (hrub\xfd, \xfasp\u011b\u0161n\xfd, vyhozen\xfd) ."})]})}function c(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}}}]);