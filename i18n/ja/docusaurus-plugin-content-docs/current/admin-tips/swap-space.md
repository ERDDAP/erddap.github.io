このコンテンツは、 [Roy Mendelssohnからのメッセージ ERDDAP ユーザーグループ](https://groups.google.com/g/erddap/c/1U0OByOasu4/m/JM39reEsBAAJ) お問い合わせ

メモリ使用上の問題が発生した多くのヘルプリクエスト ERDDAP™ お問い合わせ この一部はメモリ管理の変化から Java Linux OS のメモリ管理と相互作用する。 私は信じてから始める Java 17,717円 Java ヒープ設定に置かれるものよりもメモリを消費します。 ヒープ設定を見て、アプリケーションのメモリ使用状況を確認するには、トップ、htop、btopなどのコマンドを使用して、このことができます。 たとえば、使用した ERDDAP™ 21GBで設定されたヒープスペースを持っていますが、実際にはメモリ使用は28GB-30GBに実行できます。 システムへの同時リクエストが多い場合、この値はスパイクできます。

ほとんどの Linux システムでは、メモリ使用量が約 50% を超えると、OS はメモリを交換します。 また、ほとんどのシステムスワップスペースでは、必要な限りゴミが収集されないため、 ERDDAP™ 遅すぎると、原因が引き起こせる ERDDAP™ 凍結する。 スワップスペースが遅く、大きい datasets.xml その後、問題を合成する、完了しない主要な更新を引き起こすことができます。

お問い合わせ まず、真のメモリ使用量やシステムを見つけ、メモリ使用量が50%を超えたように十分なRAMを持っています。 しかし、この動作を変更できる2つの設定もあります。vm.swappiness。 と vm.vfs_cache_pressure.

vm.swappiness は、Linux カーネルがスワップ スペースを使用する方法を積極的に制御します。 現在の値は次のようになります。

> cat /proc/sys/vm/swappiness
>
・ デフォルトは通常60です (0から100までのスケール) お問い合わせ
・ 値を下げると、システムがスワップされる可能性が低い。
・ 10 または 1 の値は、多くの RAM のシステムに使用されます。


再起動するまでの値を変更するには、10 とします。

> sudo sysctl vm.swappiness=10
>

永続的に変更する:

> sudo nano /etc/sysctl.conf
>

vm.swappiness の値を編集します。 それから変更を加えるため:

> sudo sysctl -p
>

vm.vfs_cache_pressure ディレクティブ 記憶の回復にいかに積極的なかをシステムに伝えて下さい。 より高い値。 (100以上) より積極的なシステムに伝え、現在の値を確認してください。

> cat /proc/sys/vm/vfs_cache_pressure
>

次のリブートまで値を変更するには:

> sudo sysctl vm.vfs_cache_pressure=150
>

永続的に値を変更するには:

> sudo nano /etc/sysctl.conf
>

次に、行を追加または更新します。

> vm.vfs_cache_pressure = 100
>

そして変更を加えて下さい:

> sudo sysctl -p
>


スワップスペースの使用状況を監視し、スワップ使用量が増加し始めたらどうすればよいですか? スワップスペースを空にし、コンテンツをメモリに移動するコマンドがあります。 これを使用する前に、利用可能なメモリがスワップ使用量よりも大きいことを確認する必要があります。 ディスク使用量が大きいLinuxシステムでは「キャッシュメモリ」が非常に高いため、メモリが不足していると言いますが、このようなコマンドで必要であれば「キャッシュメモリ」が利用可能になります。

> sudo swapoff -a && sudo swapon -a
>

確かに これをやった後もゴミ収集を強制したい。

> sudo jcmd $(pgrep java) GC.run
>

再び、この情報を見つける人がいます。 作りたい ERDDAP™ 可能な限り堅牢で、実際に働く方法により、可能な限りシームレスに働きかけます。
