このコンテンツは、 [Roy Mendelssohnからのメッセージ ERDDAP ユーザーグループ](https://groups.google.com/g/erddap/c/6Hl024ZGkes/m/DS5WzsydAQAJ) お問い合わせ

 ERDDAP™ 主にサービスするコミュニティに最も使用されているデータフォーマットで作業しようとするのではなく、データフォーマットが自分のデータに使用するデータフォーマットについて認識しようとします。 より多くの作業がクラウドにあるため、クラウドで利用するデータフォーマットのplethoraがいるため、クラウドで利用している人にとっては良いでしょう。 ERDDAP™ これらのフォーマットを多くサポートできます。 アラス, ERDDAP™ 開発とメンテナンスはすでに不足しており、変更することなく、他の人の作業を使用してこの目標を達成することが望ましいです ERDDAP™ お問い合わせ

エントリー [ダックDB](https://duckdb.org/) そして、 [トリノ](https://trino.io/) お問い合わせ これらは、さまざまなデータフォーマットへの接続を提供し、JDBCを使用してアクセスすることができます。 この書き込みでは、DuckDB を使ってみるのは、あまり馴染みがあり、少なくとも私の心に Trino はもう少し複雑にセットアップされ、今は概念の証明を望んでいました。 (ダミアンSmytheの背後にある間、彼はトリノを使用する方法を疑ったと私は彼に連絡し、彼はそれを働かせて、私にメモを送信するために取得しました - 将来的にこれについて) お問い合わせ また、私は何かですが、この専門家の専門家です, ので、これは私と一緒に学びます - あなたは間違いを見つけたら私に知らせます, または不明確です物事, または物事をやっているより良い方法がある場合.

1. 予選:
——————————————

DuckDB を使用するため ERDDAP™ duckDB をコンピュータにインストールし、DuckDB JDBC コネクタをインストールする必要があります。 ERDDAP™ お問い合わせ DuckDB自体をインストールする手順は

https://duckdb.org/docs/installation/?version=stable&environment=cli&platform=macos&download_method=direct

DuckDB JDBC コネクタは、DuckDB JDBC コネクタからダウンロードできます。

https://duckdb.org/docs/stable/clients/java.html

tomcat が $TOMCAT_HOME にある場合は、このファイルを $TOMCAT_HOME/webapps/erddap/WEB-INF/lib に置きます。

2. このトリッキーを作るもの:
—————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————


少なくともDuckDBのため (私はトリノを見ていないと私は言ったように、私は、任意の詳細に)   Java プログラムは JDBC コネクタを介して DuckDB にアクセスでき、JDBC コネクタは DuckDB .db 形式で保存されているデータのみを読み込むことができます。 DuckDB は素晴らしいツールですが、このフォーマットにデータをコピーして目的全体を破る必要がありますが、DuckDB は、サポートされているファイル形式の多くのための施設を提供します (拡張機能の拡大リストがあります) 必要なメタデータで読み込まれる仮想 .db ファイルを設定できます。 かなり小さいサイズで作成される .db を見つけ、素早くアクセスできるものを提供します。 興味深いメモは、ほとんどのデータベースシステムとは異なります。 (トリノを含む) , ダック付き DBでは、常にバックグラウンドで実行されているアプリケーションを持っていないので、起動のためにアクセスにいくつかのラグがある必要がありますが、私の小さなテストアクセスで言ったように高速です。


3. 簡単な例:
—————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

まず、.csvファイルでこれを行う方法を見てみましょう。 正しい、これは使用例の興味深いものではない ERDDAP™ 既に .csv ファイルをかなりうまく処理しているので、その意味で得られるものはありませんが、テキストファイルでは何が起こっているのかを見てデバッグしやすくなり、これを学習していたので、私の人生を楽にしました。 以下は、必要なものを見ると、より興味深いユースケースを見ていきます。

機能しているファイルは、センサーによるタグ検出の305MBファイルである「detects.csv」と呼ばれます。 最初のステップは、このファイルにポイントする.dbファイルを作成することです (これと利便性のために次のものでは、私はいつもあなたが必要なレベルで働いていると仮定しますので、私はフルパスを与えません - 実際には、あなたはしなければならない) : : :

```
duckdb detects.db <<EOF
CREATE VIEW detects_table AS
SELECT *
FROM read_csv_auto(
'detects.csv',
header=true,
sample_size=2147483647 -- scan whole file for schema (optional)
);
EOF
```

"detects.db" は 268KB です。 実際に動作しているか確認することができます。

```
duckdb detects.db
DuckDB v1.3.1 (Ossivalis) 2063dda3e6
Enter ".help" for usage hints.
D SHOW TABLES;
┌───────────────┐
│ name │
│ varchar │
├───────────────┤
│ detects_table │
└───────────────┘
D SELECT * FROM detects_table LIMIT 5;
┌────────────────┬─────────┬──────────────┬───────┬──────────┬───┬──────────┬──────────────┬───────────────┬─────────┐
│ Study_ID │ TagCode │ DateTime_PST │ recv │ location │ … │ tag_life │ Rel_latitude │ Rel_longitude │ time │
│ varchar │ varchar │ timestamp │ int64 │ varchar │ │ int64 │ double │ double │ varchar │
├────────────────┼─────────┼──────────────┼───────┼──────────┼───┼──────────┼──────────────┼───────────────┼─────────┤
│ ButteSink_2024 │ 1B76 │ NULL │ NULL │ NULL │ … │ 52 │ 39.32663 │ -121.8847 │ -08 │
│ ButteSink_2024 │ 1B94 │ NULL │ NULL │ NULL │ … │ 52 │ 39.32663 │ -121.8847 │ -08 │
│ ButteSink_2024 │ 1BA5 │ NULL │ NULL │ NULL │ … │ 52 │ 39.35858 │ -121.8943 │ -08 │
│ ButteSink_2024 │ 1C55 │ NULL │ NULL │ NULL │ … │ 52 │ 39.33546 │ -121.8923 │ -08 │
│ ButteSink_2024 │ 1C95 │ NULL │ NULL │ NULL │ … │ 52 │ 39.33546 │ -121.8923 │ -08 │
├────────────────┴─────────┴──────────────┴───────┴──────────┴───┴──────────┴──────────────┴───────────────┴─────────┤
│ 5 rows 18 columns (9 shown) │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

そして検出のサイズ。 db はこの操作から変更されていません。 そこで最終ステップは、これと接続することです。 ERDDAP™ , 私は、すべての変数情報ではなく、ファイルに接続するために必要な部分だけを示しています。

```
<dataset type="EDDTableFromDatabase" datasetID="duckdb_test" active="true">
<!-- JDBC Connection Details -->
<sourceUrl>jdbc:duckdb:detects.db</sourceUrl>
<driverName>org.duckdb.DuckDBDriver</driverName>
<catalogName></catalogName>
<schemaName></schemaName>
<tableName>detects_table</tableName>
<columnNameQuotes></columnNameQuotes>
>
```

そして、これはデータセットです ERDDAP™ DuckDB コネクターを使用してラップトップで:
