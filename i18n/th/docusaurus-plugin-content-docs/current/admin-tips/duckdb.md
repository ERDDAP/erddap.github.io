เนื้อหานี้ขึ้นอยู่กับ [ข้อความจากรอย เมนเดลสัน ERDDAP กลุ่มผู้ใช้](https://groups.google.com/g/erddap/c/6Hl024ZGkes/m/DS5WzsydAQAJ) .

 ERDDAP™ พยายามอธิบายว่าคนเราใช้รูปแบบข้อมูลอะไรเพื่อข้อมูล แต่พยายามทํางานกับรูปแบบข้อมูล เมื่องานมากขึ้นและมากขึ้นในเมฆ และมีรูปแบบของข้อมูล ที่คนใช้ในเมฆ มันจะดีถ้า ERDDAP™ สามารถรองรับรูปแบบเหล่านี้ได้ อนิจจา ERDDAP™ การ พัฒนา และ การ บํารุง รักษา อยู่ ใต้ อํานาจ แล้ว และ สิ่ง ที่ น่า ปรารถนา คือ การ ใช้ ประโยชน์ จาก งาน ของ คน อื่น ๆ เพื่อ บรรลุ เป้า หมาย นี้ โดย ไม่ ต้อง แก้ไข ERDDAP™ .

เข้า [ดั๊กบี](https://duckdb.org/) ถึง [ทริโน](https://trino.io/) . ทั้ง สอง อย่าง นี้ ทํา ให้ มี การ เชื่อม โยง กับ รูป แบบ ข้อมูล หลาก หลาย และ สามารถ เข้า ถึง ได้ โดย ใช้ JDBC. ในการเขียนนี้ ผมจะดูแค่การใช้ ดั๊กดีบี เพราะผมคุ้นเคยกับมัน, และไทรโน อย่างน้อย ในความคิดของผม, ดูซับซ้อนขึ้นหน่อย, (ตอนที่เดเมี่ยน สมิธ เขียนว่า เขาได้ยื่นคําร้องให้ วิธีใช้ไทรโน่ และผมติดต่อเขา) . นอกจากนี้ฉันยังเป็นอะไรก็ได้ที่เชี่ยวชาญในเรื่องนี้ ดังนั้นนี้คือการเรียนรู้ร่วมกับฉัน - บอกฉันถ้าคุณพบความผิดพลาดใด ๆ หรือสิ่งที่ไม่ชัดเจนหรือถ้ามีวิธีการที่ดีกว่าในการทํา

1. พรีเมียร์:
-- ---- ----

ในการใช้ DuckDB ใน ERDDAP™ คุณต้องติดตั้งเป็ด DB บนคอมพิวเตอร์ของคุณ และติดตั้ง ดั๊กดีบี JDBC เชื่อมต่อ ERDDAP™ . คําสั่งในการติดตั้ง DuckDB ตัวเองอยู่ที่

https://duckdb.org/docs/installation/?version=stable&environment=cli&platform=macos&download_method=direct

ตัวเชื่อมต่อ DIDB JDBC สามารถดาวน์โหลดได้จาก

https://duckdb.org/docs/stable/clients/java.html

ถ้าทอมแคทของคุณอยู่ที่ $TOMCAT_HOME คุณก็ต้องใส่แฟ้มนี้ที่ $TOMCAT_HME/Webapps/erdap/WEB-NF/lib

2. อะไรทําให้กลเม็ดนี้
ดัตช์)


อย่างน้อยก็สําหรับ DuckDB (ดัง ที่ ผม บอก ว่า ผม ไม่ ได้ มอง ทริ โน ใน ราย ละเอียด ใด ๆ)   Java โปรแกรมสามารถเข้าถึง DugDB ได้โดยผ่านทางตัวเชื่อมต่อ JDBC และตัวเชื่อมต่อ JDBC จะสามารถอ่านได้เฉพาะข้อมูลที่ถูกเก็บไว้ในรูปแบบ DDB ในขณะที่ DuckDB เป็นเครื่องมือที่ดี, ต้องคัดลอกข้อมูลไปในรูปแบบนี้เอาชนะวัตถุประสงค์ทั้งหมด อย่างไรก็ตาม ดั๊กดีบีจัดหาอุปกรณ์ที่สําหรับหลายรูปแบบแฟ้มที่รองรับ (มีรายการนามสกุลที่เพิ่มขึ้น) คุณสามารถตั้งค่าแฟ้ม .db ที่กําลังอ่านอยู่ในข้อมูลกํากับภาพที่ต้องการได้ ผมเจอ .db ที่สร้างขึ้นให้มีขนาดเล็กมาก และให้สิ่งที่ดูเหมือน เข้าถึงได้อย่างรวดเร็ว โน้ตที่น่าสนใจคือ ไม่เหมือนกับระบบฐานข้อมูลส่วนใหญ่ (รวมถึงไทรโน่ด้วย) กับเป็ด DB คุณยังไม่มีโปรแกรมที่ทํางานอยู่เบื้องหลังอยู่ จึงต้องมีการเข้าถึงที่ล่าช้าบางส่วนเนื่องจากเริ่มต้น แต่อย่างที่ผมบอกในการทดสอบขนาดเล็ก ดูเป็นความรวดเร็ว


3. ตัวอย่างง่ายๆ:
คือ (มะลาอิกะฮฺ) ผู้ทรงเกียรติเป็นผู้คุ้มกันรักษา

เพื่อเริ่มต้น ผมจะดูวิธีการทํานี้ ด้วยแฟ้ม .csv ถูก แล้ว นี่ ไม่ น่า สนใจ ใน กรณี ที่ ใช้ ERDDAP™ การจัดการแฟ้ม .csv ได้เป็นอย่างดี ดังนั้นไม่มีอะไรได้รับในความรู้สึกนั้น แต่ไฟล์ข้อความนั้น ง่ายกว่าที่จะทํางานกับมัน และดีบั๊กในการเห็นสิ่งที่กําลังเกิดขึ้น ข้างล่างผมจะดูที่กรณีที่มีประโยชน์มากขึ้น เมื่อเราเห็นสิ่งที่จําเป็น

แฟ้มที่ผมกําลังทําอยู่นี้เรียกว่า "ตรวจสอบ.csv" ซึ่งเป็นแฟ้มการตรวจสอบแท็ก 305MB โดยเซ็นเซอร์ ก้าวแรกคือสร้างแฟ้ม .db ที่ชี้ไปยังแฟ้มนี้ (ในนี้ และสิ่งที่ตามมาเพื่อความสะดวก ผมจะถือว่าคุณทํางานในระดับที่ต้องการเสมอ) .

```
duckdb detects.db <<EOF
CREATE VIEW detects_table AS
SELECT *
FROM read_csv_auto(
'detects.csv',
header=true,
sample_size=2147483647 -- scan whole file for schema (optional)
);
EOF
```

แฟ้ม "ตรวจสอบ.db" มีขนาด 268KB. เราสามารถตรวจสอบได้ว่ามันได้ผลจริงๆ

```
duckdb detects.db
DuckDB v1.3.1 (Ossivalis) 2063dda3e6
Enter ".help" for usage hints.
D SHOW TABLES;
┌───────────────┐
│ name │
│ varchar │
├───────────────┤
│ detects_table │
└───────────────┘
D SELECT * FROM detects_table LIMIT 5;
┌────────────────┬─────────┬──────────────┬───────┬──────────┬───┬──────────┬──────────────┬───────────────┬─────────┐
│ Study_ID │ TagCode │ DateTime_PST │ recv │ location │ … │ tag_life │ Rel_latitude │ Rel_longitude │ time │
│ varchar │ varchar │ timestamp │ int64 │ varchar │ │ int64 │ double │ double │ varchar │
├────────────────┼─────────┼──────────────┼───────┼──────────┼───┼──────────┼──────────────┼───────────────┼─────────┤
│ ButteSink_2024 │ 1B76 │ NULL │ NULL │ NULL │ … │ 52 │ 39.32663 │ -121.8847 │ -08 │
│ ButteSink_2024 │ 1B94 │ NULL │ NULL │ NULL │ … │ 52 │ 39.32663 │ -121.8847 │ -08 │
│ ButteSink_2024 │ 1BA5 │ NULL │ NULL │ NULL │ … │ 52 │ 39.35858 │ -121.8943 │ -08 │
│ ButteSink_2024 │ 1C55 │ NULL │ NULL │ NULL │ … │ 52 │ 39.33546 │ -121.8923 │ -08 │
│ ButteSink_2024 │ 1C95 │ NULL │ NULL │ NULL │ … │ 52 │ 39.33546 │ -121.8923 │ -08 │
├────────────────┴─────────┴──────────────┴───────┴──────────┴───┴──────────┴──────────────┴───────────────┴─────────┤
│ 5 rows 18 columns (9 shown) │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

และขนาดของการตรวจสอบ db ไม่ได้เปลี่ยนจากการทําปฏิบัติการนี้ ดังนั้นขั้นตอนสุดท้ายคือการเชื่อมต่อกับ ERDDAP™ ผมแสดงเฉพาะส่วนที่จําเป็นในการเชื่อมต่อกับแฟ้ม ไม่ใช่ข้อมูลทั้งหมด

```
<dataset type="EDDTableFromDatabase" datasetID="duckdb_test" active="true">
<!-- JDBC Connection Details -->
<sourceUrl>jdbc:duckdb:detects.db</sourceUrl>
<driverName>org.duckdb.DuckDBDriver</driverName>
<catalogName></catalogName>
<schemaName></schemaName>
<tableName>detects_table</tableName>
<columnNameQuotes></columnNameQuotes>
>
```

และนี่คือชุดข้อมูลใน ERDDAP™ บนแลปทอปของฉันโดยใช้ตัวเชื่อมต่อ DuckDB:
