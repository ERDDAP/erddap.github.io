ต้องขอบคุณรอย เมนเดลสัน ที่เขียนเรื่องนี้ขึ้นมา

เดอะ Python แพกเกจ 'xarray' เป็นที่นิยมมากสําหรับการเข้าใช้, จัดวางและทําภาพข้อมูลแบบ Gried ในรูปแบบต่าง ๆ 'xray' ทํางานได้ดีกับ ERDDAP™ ถ้าคุณเข้าใจวิธีการใช้มันอย่างถูกต้อง ผมจะชี้ให้เห็นว่า Python แพ็กเกจ ' ( https://github.com/ioos/erddapy ) สามารถเข้าใช้งานข้อมูลจาก ERDDAP™ เซิร์ฟเวอร์ใช้ทั้ง 'gridadap' และ ' tabledap 'ตอนที่ 'xarray' ถูกจํากัดให้เข้ารหัสข้อมูล และ 'erddapy' สามารถส่งออกข้อมูลสําหรับ 'xarray' ได้ แต่ถ้าคุณคุ้นเคยกับการใช้ 'xarray' และมีการไหลของงานโดยใช้แพ็คเกจแล้ว ก็สามารถที่ต้องการเพียงแค่การทํางานภายในแพ็คเกจเดียว

ชุดข้อมูลที่ผมชอบที่สุดชุดหนึ่ง คือ JPL MURV4.1 ข้อมูล SST ที่ใช้ได้ https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41.html . ถ้าผมอยากทําสับเซตของข้อมูลที่บอกว่า 28 January 2026, Latitus (20, 50) และเส้นแวง (-140, -105) และดาวน์โหลดแฟ้ม Netcdf ERDDAP™ ที่อยู่ URL นี้จะเป็น https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41.nc?analysed_sst[(2026-01-28T09:00:00Z 1 : (2026-01-28T09:00Z) ) [ (20) 1 : (50) ) [ (-140) 1 : (-105) [และมันก็สมเหตุสมผลที่จะคิดว่า นี่คือสิ่งที่คุณจะใช้ใน 'xarray'. แต่ที่จริงถ้าคุณทําอย่างนั้น คุณจะได้ความคลาดเคลื่อน

เหตุผลที่มันทําให้เกิดข้อผิดพลาด คือ 'xarray' ใช้ OPeNDAP   ( https://www.opendap.org ) เป็นโปรโตคอลสําหรับการเข้าถึงระยะไกลและในขณะที่ ERDDAP™ ไวยากรณ์มีพื้นฐาน OPeNDAP ไวยากรณ์ และ ERDDAP™ เครื่องแม่ข่ายยังสามารถทําหน้าที่เป็น OPeNDAP เซิร์ฟเวอร์, มีความแตกต่างในการทําเช่นนี้ เพื่อบริการทั้งสอง (ดูตัวอย่าง https://coastwatch.pfeg.noaa.gov/erddap/griddap/documentation.html#opendapLibraries ) .

ถ้าเราคิดถึงขั้นตอนในการเข้าถึงพื้นที่ NetCDF แฟ้มใน 'xarray' เราจะทําขั้นตอนต่อไปนี้:

- เปิดแฟ้มโดยการชี้ไปยังพาธเต็มของแฟ้ม
- ดูข้อมูลพิกัดจากขั้นตอนแรก
- ใช้วิธีการ "เลือก" อย่างใดอย่างหนึ่งเพื่อจัดเรียงข้อมูล

ด้านบนคุณเปิดแฟ้มก่อน แล้วทําสับเซต ใช้ 'xarray' กับ ERDDAP™ ข้อมูลชุดที่คุณทําเหมือนกัน, เมื่อคุณสังเกต, ตามคําอธิบาย ERDDAP™ เอกสาร, ที่ว่า "พาธไปยังแฟ้ม" คือที่อยู่ URL โดยไม่ต้องมีรูปแบบการตอบกลับใด ๆ และไม่มี contraints, ในกรณีของข้อมูล MUR https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41.
 

เพื่อเป็นตัวอย่างที่ชัดเจน โดยใช้ชุดข้อมูล MUR อันดับแรก ผมต้องนําเข้าแพกเกจที่จะใช้:


```python
import matplotlib.pyplot as plt
import xarray as xr
```

จากนั้น, ขณะที่ descied เหนือฉันตั้งค่าที่อยู่ URL ไปยังข้อมูลชุด "ชื่อ" และเปิด "แฟ้ม" (ไม่ใช่ว่ามันเป็นการรวมแฟ้มเข้าไปด้วย) ใช้ "xr. open_datatet"


```python
mur_url = "https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41"
ds = xr.open_dataset(mur_url, decode_times=True)


```

นี่ ก่อ ให้ เกิด ผล ต่อ ไป นี้ (บาง) ผลใน "ds":

ขนาด:

เวลา: 8641l atital: 1799 ลองจิจูด: 36000

พิกัด:

เวลา (เวลา) 2026-01...
เส้นรุ้ง (เส้นรุ้ง) 2032–89.99–89.98. 89.98. 89.99.
เส้นแวง (เส้นแวง) Follow32 - 18080.0–801.0... 180.0 180.0.

ดัชนี:

เวลาของแพนด้าIndex
เส้นทแยง
เส้นแวง แพนด้าIndex


ณ จุดนี้คุณดําเนินการเช่นเดียวกับคุณจะได้มันเป็นไฟล์ท้องถิ่น ผมยกตัวอย่างสองอันข้างล่าง, อันที่ใช้เวลา 2 ครั้งสุดท้าย โดยใช้อาร์เรย์ทําดัชนี และอันที่หาค่าของ 2 ครั้งที่ผ่านมา แล้วใช้มันสร้างสับเซต, แต่ในกรณีนี้


```python
lat_min, lat_max = 20, 50
lon_min, lon_max = -140, -105
sub_isel = ds.isel(time=slice(-2, None)).sel(
    latitude=slice(lat_min, lat_max),
    longitude=slice(lon_min, lon_max),
)
# plot the result
#sub_isel["analysed_sst"].isel(time=0).plot()
```


```python
last2 = ds["time"].values[-2:]
sub_sel = ds.sel(time=last2).sel(
    latitude=slice(lat_min, lat_max),
    longitude=slice(lon_min, lon_max),
)
# plot the result
#sub_sel["analysed_sst"].isel(time=0).plot()


```

ดังนั้นการนําข้อความกลับบ้านก็คือ 'xarray' ทํางานได้ดีสําหรับข้อมูลที่ถูกย่างใน ERDDAP™ เครื่องแม่ข่าย หากคุณส่งต่อไปยัง 'xr. open_ datataet () 'ที่ ERDDAP™ ที่อยู่ URL ไม่มีประเภทแฟ้ม และไม่มีข้อจํากัด
