Χάρη στον Ρόι Μέντελσον γι' αυτό.

Η Python πακέτο 'xarray' έχει γίνει πολύ δημοφιλής για την πρόσβαση, υποκατάσταση και οπτικοποίηση των δεδομένων σε μια ποικιλία μορφών. \"Συγχώνευση\" λειτουργεί μια χαρά με ERDDAP™ Μόλις καταλάβεις πώς να το χρησιμοποιήσεις σωστά. (Χειροκροτήματα) Python πακέτο 'erddapy' \" ( https://github.com/ioos/erddapy ) μπορεί να έχει πρόσβαση σε δεδομένα από ERDDAP™ εξυπηρετητές που χρησιμοποιούν τόσο 'griddap' όσο και ' tabledap \", ενώ η \"εξομοίωση\" περιορίζεται σε κωδικοποιημένα δεδομένα, και η \"erddapy\" μπορεί να εξαγάγει τα δεδομένα για την \"εξομοίωση\". Αλλά αν είστε συνηθισμένοι στη χρήση \"xarray\" και έχουν ροές εργασίας χρησιμοποιώντας το πακέτο, τότε μπορεί να είναι επιθυμητό να λειτουργήσει μόνο μέσα στο ενιαίο πακέτο.

Ένα από τα αγαπημένα μου σύνολα δεδομένων είναι τα δεδομένα JPL MURv4.1 SST διαθέσιμα στο https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41.html . Αν θέλω να κάνω ένα υποσύνολο των δεδομένων για παράδειγμα στις 28 Ιανουαρίου 2026, latitdues (20,50) και γεωγραφικό μήκος (-140, -105) , και να κατεβάσετε ένα αρχείο netcdf, το ERDDAP™ URL για αυτό θα ήταν https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41.nc?analysed_sst[(2026-01-28T09:00:00Z ):1: (2026-01-28T09:00:00Z) ] [ (20) : 1: (50) ] [ (-140) : 1: (-105) ] και είναι λογικό να υποθέσουμε ότι αυτό είναι που θα χρησιμοποιούσατε στην «έκθεση». Αλλά στην πραγματικότητα αν το κάνεις αυτό, θα έχεις ένα λάθος.

Ο λόγος για τον οποίο αυτό παράγει ένα σφάλμα είναι ότι το \"xarray\" χρησιμοποιεί OPeNDAP   ( https://www.opendap.org ) ως πρωτόκολλο για την απομακρυσμένη πρόσβαση, και ενώ η ERDDAP™ Η σύνταξη βασίζεται σε OPeNDAP σύνταξη, και ERDDAP™ Ο εξυπηρετητής μπορεί επίσης να λειτουργήσει ως εξυπηρετητής OPeNDAP server, υπάρχουν διαφορές στον τρόπο με τον οποίο γίνεται αυτό για τις δύο υπηρεσίες. (Βλέπε για παράδειγμα https://coastwatch.pfeg.noaa.gov/erddap/griddap/documentation.html#opendapLibraries ) .

Αν σκεφτούμε τα βήματα για πρόσβαση σε ένα τοπικό NetCDF αρχείο στο 'xarray' θα κάνουμε τα ακόλουθα βήματα:

- Άνοιγμα του αρχείου δείχνοντας την πλήρη διαδρομή του αρχείου
- Δείτε τις πληροφορίες συντεταγμένων από το πρώτο βήμα
- Χρησιμοποιήστε μια από τις διάφορες "επιλέξτε" μεθόδους για να υπορυθμίσετε τα δεδομένα

Στα παραπάνω ανοίγετε πρώτα το αρχείο και μετά κάνετε την υπο-ρύθμιση. Για να χρησιμοποιήσετε το 'xarray' με ένα ERDDAP™ Το σύνολο δεδομένων που κάνετε το ίδιο, μόλις συνειδητοποιήσετε, όπως εξηγείται στο ERDDAP™ τεκμηρίωση, ότι η "διαδρομή προς το αρχείο" είναι το URL χωρίς καμία μορφή επιστροφής και χωρίς καμία αντίθεση, στην περίπτωση του συνόλου δεδομένων MUR που είναι https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41.
 

Ως συγκεκριμένο παράδειγμα χρησιμοποιώντας το σύνολο δεδομένων MUR, πρέπει πρώτα να εισάγω τα πακέτα που θα χρησιμοποιηθούν:


```python
import matplotlib.pyplot as plt
import xarray as xr
```

Στη συνέχεια, όπως αποσιωπήθηκε παραπάνω Θέτω το URL στο σύνολο δεδομένων "όνομα" και να ανοίξει το αρχείο. (όχι ότι είναι στην πραγματικότητα μια συγκέντρωση αρχείων) με χρήση "xr.open_dataset"


```python
mur_url = "https://coastwatch.pfeg.noaa.gov/erddap/griddap/jplMURSST41"
ds = xr.open_dataset(mur_url, decode_times=True)


```

Αυτό παράγει τα ακόλουθα (μερική) αποτελέσματα σε "ds":

Διαστάσεις:

Χρόνος: 8641l σε πλάτος: 17999 γεωγραφικό μήκος: 36000

Συντεταγμένες:

χρόνος (χρόνος) datetime64[ns] 2002-06-01T09:00:00 ... 2026-01-...
γεωγραφικό πλάτος (γεωγραφικό πλάτος) Επίπλευση32 -89.99 -89.98 ... 89.98 89.99
γεωγραφικό μήκος (γεωγραφικό μήκος) πλωτήρα32-180.0-180.0 ... 180.0 180.0

Δείκτες:

χρόνος PandasIndex
γεωγραφικό πλάτος PandasIndex
γεωγραφικό μήκος ΠάνταIndex


Σε αυτό το σημείο θα προχωρήσει ακριβώς όπως θα ήταν ένα τοπικό αρχείο. Δίνω δύο παραδείγματα παρακάτω, ένα που παίρνει τις δύο τελευταίες φορές με τη χρήση ευρετηρίου συστοιχίας και ένα που παίρνει τις τιμές των δύο τελευταίων και χρησιμοποιεί αυτό για να κάνει το υποσύνολο, αλλά σε κάθε περίπτωση αυτό είναι πανομοιότυπο με αυτό που θα κάνατε για ένα τοπικό αρχείο.


```python
lat_min, lat_max = 20, 50
lon_min, lon_max = -140, -105
sub_isel = ds.isel(time=slice(-2, None)).sel(
    latitude=slice(lat_min, lat_max),
    longitude=slice(lon_min, lon_max),
)
# plot the result
#sub_isel["analysed_sst"].isel(time=0).plot()
```


```python
last2 = ds["time"].values[-2:]
sub_sel = ds.sel(time=last2).sel(
    latitude=slice(lat_min, lat_max),
    longitude=slice(lon_min, lon_max),
)
# plot the result
#sub_sel["analysed_sst"].isel(time=0).plot()


```

Έτσι, το μήνυμα στο σπίτι είναι ότι το \"xarray\" λειτουργεί πολύ καλά για τα δεδομένα σε πλέγμα σε ένα ERDDAP™ εξυπηρετητής αν περάσετε στο 'xr.open_dataset' () (') ΕΕ αριθ. ERDDAP™ URL χωρίς τύπο αρχείου και χωρίς περιορισμούς.
