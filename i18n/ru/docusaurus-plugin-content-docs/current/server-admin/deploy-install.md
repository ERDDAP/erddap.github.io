---
sidebar_position: 1
---

# устанавливать
Как сделать начальную настройкуERDDAP™На вашем сервере


ERDDAP™Может работать на любом сервере, который поддерживаетJavaи Tomcat (и другие серверы приложений, такие как Jetty, но мы не поддерживаем их) .ERDDAP™Проверено на Linux (В том числе на Amazon AWS) Компьютеры Mac и Windows.
*    **Докер** - Мы предоставляем[ERDDAP™В контейнере Docker](https://hub.docker.com/r/erddap/erddap)IOOS теперь предлагает[Руководство для быстрого стартаERDDAP™В контейнере Docker](https://ioos.github.io/erddap-gold-standard/index.html).
Это стандартERDDAP™Установка в контейнере Docker.
Через Docker Сочиняем мы предлагаем простые способы настройки Ssl и мониторинга, читайте дальше[Документация Docker](https://github.com/ERDDAP/erddap/blob/main/DOCKER.md).
Если вы уже используете Docker, вы, вероятно, предпочтете версию Docker.
Если вы хотите работать на облачных сервисах, вы, вероятно, предпочтете версию Docker.
*    **Amazon** - Если вы устанавливаетеERDDAP™На примере Amazon Web Services EC2 см.[Обзор веб-сервисов Amazon](/docs/server-admin/additional-information#amazon)Сначала.
*    **Linux и Mac** -ERDDAP™Отлично работает на компьютерах Linux и Mac. Смотрите инструкции ниже.
*    **Windows** - Windows отлично подходит для тестированияERDDAP™и для личного использования (Смотрите инструкции ниже) Но мы не рекомендуем использовать его для общественности.ERDDAPС. бегатьERDDAP™В Windows могут возникнуть проблемы, в частности:ERDDAP™Может быть невозможно быстро удалить и/или переименовать файлы. Вероятно, это связано с антивирусным программным обеспечением. (Например, от McAfee и Norton) Проверка файлов на наличие вирусов. Если вы столкнулись с этой проблемой (которые можно увидеть по сообщениям об ошибках в[log.txt](/docs/server-admin/additional-information#log)Файл «Невозможно удалить...») Изменение настроек антивирусного программного обеспечения может частично облегчить проблему. Или подумайте об использовании сервера Linux или Mac.

 **СтандартERDDAP™Инструкции по установке для компьютеров Linux, Mac и Windows:** 

0. Убедитесь, что все зависимости установлены. На машинах без Windows (Linux и Mac) Вам нужен CSH.
## Java {#java} 
1.  [ДляERDDAP™v2.19+, установленныйJava21.](#java)
По соображениям безопасности почти всегда лучше использовать последнюю версию.Java21.
Пожалуйста, загрузите и установите последнюю версию
    [Открытый JDK (Темурин) 21 (LTS) ](https://adoptium.net/temurin/releases/?version=21). Для проверки установки введите, например, "/_javaJreBinDirectory_/java-version".
/usr/local/jdk-21.0.3+9/jre/bin/java инверсия
    
    ERDDAP™работать сJavaиз других источников, но мы рекомендуем Adoptium, потому что это основной, поддерживаемый сообществом, бесплатный (Как в пиве и речи) версияJava21 Долгосрочная поддержка (Бесплатные обновления в течение многих лет после первоначального выпуска) . По соображениям безопасности, пожалуйста, обновитеERDDAPверсияJavaпериодически в виде новых версийJava21 Стать доступным из Adoptium.
    
    ERDDAP™Он был протестирован и широко использовался с 21, а не с другими версиями. По разным причинам мы не тестируем и не поддерживаем другие версии.Java.
     
## Томкат{#tomcat} 
2.  [Настройка](#tomcat) [Томкат](https://tomcat.apache.org).
Tomcat является наиболее широко используемымJavaСервер приложений, которыйJavaпрограммное обеспечение, которое находится между сетевыми службами операционной системы иJavaСерверное программное обеспечение какERDDAP™. Бесплатное и открытое программное обеспечение (Фосс) .
    
Вы можете использовать другойJavaСервер приложений (Например, Jetty) Мы тестируем и поддерживаем только Tomcat.
     
    
    * Загрузите Tomcat и распакуйте его на своем сервере или ПК.
Из соображений безопасности лучше всего использовать последнюю версию Tomcat 10. (Версия 9 и ниже не приемлемы.) который предназначен для работы сJava21 или больше. Ниже каталог Tomcat будет называться _tomcat_.
        
Предупреждение&#33; Если у вас уже есть Tomcat с другим веб-приложением (Особенно дреды) Мы рекомендуем вам установитьERDDAP™в[Второй Tomcat](/docs/server-admin/additional-information#second-tomcat)Потому чтоERDDAP™Он нуждается в различных настройках Tomcat и не должен конкурировать с другими приложениями для памяти.
        
        * На Linux,[Скачать «Core» «tar».gzРаспределение "Томкат"](https://tomcat.apache.org/download-10.cgi)и распаковать его. Мы рекомендуем распаковать его в /usr/local.
        * На Mac Tomcat, вероятно, уже установлен в /Library/Tomcat, но должен обновить его до последней версии Tomcat 10.
Если вы загрузите его,[Скачать «Core» «tar».gzРаспределение "Томкат"](https://tomcat.apache.org/download-10.cgi)Разместите его в библиотеке /Tomcat.
        * В Windows вы можете[Скачать дистрибутив «Core» «zip» Tomcat](https://tomcat.apache.org/download-10.cgi)  (который не имеет проблем с реестром Windows и который вы контролируете из командной строки DOS) и распаковать его в соответствующем каталоге. (Для разработки мы используем дистрибутив «Core» «zip». Мы создаем каталог /программ и распаковываем его там.) Или вы можете скачать «Core» «64-битный Windows zip» дистрибутив, который включает в себя больше функций. Если дистрибутив является установщиком Windows, он, вероятно, поместит Tomcat, например, в /Program Files/apache-tomcat-10.0.23.
             
### server.xml{#serverxml} 
*   [server.xml](#serverxml)В файле _tomcat_/conf/server.xml есть два изменения.&lt;Connector&gt; Tags - один для
```
        <Connector port="8080" 
```
и один для
```
        <Conector port="8443"
```
    1.   (рекомендованный) Увеличить значение параметра Timeout, возможно, до 300000 (миллисекунды)   (Который составляет 5 минут) .
    2.   (рекомендованный) Добавить новый параметр: relaxedQueryChars="\\[\\]|" Это необязательно и немного менее безопасно, но устраняет необходимость в том, чтобы пользователи кодировали эти символы, когда они возникают в параметрах URL-адреса запроса пользователя.
             
### Content.xml{#contentxml} 
* context.xml Ресурсы кэша - В _tomcat_/conf/context.xml непосредственно перед&lt;/Context&gt; tag, изменить тег Ресурсы (или добавить его, если его еще нет) Чтобы установить кэш Параметр MaxSize 80000:
    &lt;Разрешено кэширование ресурсов = «настоящий» кэшMaxSize = «80000» /&gt;
Это позволяет избежать многочисленных предупреждений при каталине. Все начинается с
"Предупреждение\\[основной\\]org.apache.catalina.webresources.Cache.getResource Невозможность добавить ресурс в\\[/WEB-INF/классы/...]"
         
### Apache Timeout{#apache-timeout} 
* На компьютерах Linux измените настройки тайм-аута Apache, чтобы отнимающие много времени запросы пользователей не отставали. (часто появляется как ошибка «Прокси» или «Плохой шлюз») . Как корневой пользователь:
    1. Модифицировать Apachehttpd.conf файл (обычно в /etc/httpd/conf/) :
Изменить существующее&lt;Timeout &gt; установка (Добавить в конце файла) до 3600 (секунды) Вместо стандартных 60 или 120 секунд.
Изменить существующее&lt;ProxyTimeout &gt; настройка (Добавить в конце файла) до 3600 (секунды) Вместо стандартных 60 или 120 секунд.
    2. Перезапуск Apache: /usr/sbin/apachectl -к грациозный (Но иногда он находится в другом каталоге.) .
             
    * Рекомендация по безопасности: Видишь?[Эти инструкции](https://tomcat.apache.org/tomcat-10.0-doc/security-howto.html)повысить безопасность установки Tomcat, особенно для общедоступных серверов.
         
    * Для публикиERDDAP™Установки на Linux и Mac, лучше всего настроить Tomcat (Программа) как принадлежащий пользователю "tomcat" (отдельный пользователь с ограниченными правами и[Пароль отсутствует](https://unix.stackexchange.com/questions/56765/creating-an-user-without-a-password)) . Таким образом, только суперпользователь может переключиться на действия в качестве пользовательского томата. Это делает невозможным для хакеров вход на ваш сервер в качестве пользовательского томата. И в любом случае, вы должны сделать это так, чтобы у пользователя Tomcat были очень ограниченные разрешения на файловую систему сервера (читай + записывай + выполняй привилегии для дерева каталогов apache-tomcat).&lt;bigParentDirectory&gt; и привилегии только для чтения каталогов с данными, которыеERDDAP™Нужен доступ.
        * Вы можете создать учетную запись пользователя Tomcat (который не имеет пароля) Используя команду
sudo useradd tomcat -s /bin/bash -p '' "
        * Вы можете переключиться на работу в качестве пользователя Tomcat, используя команду
Судо Су - томкат
             (Он попросит у вас пароль суперпользователя для разрешения на это.) 
        * Вы можете перестать работать как пользователь Tomcat, используя команду
выход
        * Выполняйте большую часть работы иERDDAP™Настройка инструкций как пользователь «tomcat». Позже запустите скрипты startup.sh и shutdown.sh в качестве пользовательского «tomcat», чтобы у Tomcat было разрешение писать в свои файлы журналов.
        * После распаковки Tomcat из родительского каталога apache-tomcat:
            
            * Измените право собственности на дерево каталогов apache-tomcat для пользователя томата.
Р. Томкат апач-томкат-_10.0.23_
                 (Замените фактическое имя вашего каталога Tomcat) .
            * Измените «группу» на Tomcat, ваше имя пользователя или название небольшой группы, которая включает в себя Tomcat и всех администраторов Tomcat.ERDDAPНапример,
CHGRP -R_Your UserName_ apache-tomcat_10.0.23_
            * Изменяйте разрешения, чтобы Tomcat и группа читали, писали, выполняли привилегии.
chmod -R ug+rwx apache-tomcat-_10.0.23_
            * Удалите «другие» разрешения пользователя на чтение, запись или выполнение:
chmod -R o-rwx apache-tomcat-_10.0.23_
Это важно, потому что это мешает другим пользователям читать потенциально конфиденциальную информацию.ERDDAP™Настройка файлов.
            
              
### Память{#memory} 
* Переменные среды Tomcat
    
Linux и Mac:
Создание файла _tomcat_/bin/setenv.sh (В Red Hat Enterprise Linux\\[Рейл\\]Редактировать ~tomcat/conf/tomcat10.conf) Установить переменные среды Tomcat. Этот файл будет использоваться _tomcat_/bin/startup.sh и shutdown.sh. Файл должен содержать что-то вроде:
```
    export JAVA\\_HOME=/usr/local/jdk-21.0.3+9  
    export JAVA\\_OPTS='-server -Djava.awt.headless=true -Xmx1500M -Xms1500M'  
    export TOMCAT\\_HOME=/usr/local/apache-tomcat-_10.0.23_  
    export CATALINA\\_HOME=/usr/local/apache-tomcat-_10.0.23_
```
 (Замените имена каталогов с вашего компьютера) .
 (Если вы ранее установили JRE_HOME, вы можете удалить это.)   
На Mac вам, вероятно, не нужно устанавливать JAVA_HOME.

В Windows:
Создайте файл _tomcat_\\bin\\setenv.bat для установки переменных среды Tomcat. Этот файл будет использоваться _tomcat_\\bin\\startup.bat иshutdown.bat. Файл должен содержать что-то вроде:
```
    SET "JAVA\\_HOME=\\_someDirectory_\\jdk-21.0.3+9"  
    SET "JAVA\\_OPTS=-server -Xmx1500M -Xms1500M"  
    SET "TOMCAT\\_HOME=\\Program Files\\apache-tomcat-_10.0.23_"  
    SET "CATALINA\\_HOME=\\Program Files\\apache-tomcat-_10.0.23_"
```
 (Замените имена каталогов с вашего компьютера) .
Если это только для локального тестирования, удалите «-сервер».
 (Если вы ранее установили JRE_HOME, вы можете удалить это.) 

Настройки памяти -Xmx и -Xms важны, потому чтоERDDAP™Лучше работать с большей памятью. Всегда устанавливайте -Xms на то же значение, что и -Xmx.

* Для 32-битных операционных систем и 32-битныхJava:
64 битJavaГораздо лучше, чем 32 битJavaНо 32 битJavaРаботает до тех пор, пока сервер не занят. Чем больше физической памяти на сервере, тем лучше: 4+ ГБ - это действительно хорошо, 2 ГБ - это нормально, меньше не рекомендуется. 32-битныйJavaДаже с обильной физической памятью, Tomcat иJavaне будет работать, если вы попытаетесь установить -Xmx намного выше 1500M (1200 М на некоторых компьютерах) . Если ваш сервер имеет менее 2 ГБ памяти, уменьшите значение -Xmx. (Исполнитель: 'M'egaBytes) 1/2 физической памяти компьютера.
* Для 64-битных операционных систем и 64-битныхJava:
64 битJavaРаботает только на 64-битной операционной системе.
    
    * сJava8, нужно добавить \\-d64 к параметру Tomcat CATALINA\\_OPTS в setenv.bat
    * сJava21, выберите 64 битJavaКогда вы загружаете версиюJavaПомечено "64 бит".
    
64-битныйJavaТомкэт иJavaМожно использовать очень высокие настройки -Xmx и -Xms. Чем больше физической памяти на сервере, тем лучше. В качестве упрощенного предложения: рекомендуем установить -Xmx и -Xms на (Исполнитель: 'M'egaBytes) до 1/2 (менее) Физическая память компьютера. Посмотрим, Томкэт ли,JavaиERDDAP™Действительно работает в 64-битном режиме, ища «бит», вERDDAPЕжедневный отчет по электронной почте или в _bigParentDirectory_/logs/[log.txt](/docs/server-admin/additional-information#log)файл (_bigParentDirectory_ указывается в[Настройка.xml](#setupxml)) .
#### Коллекция Garbage{#garbage-collection} 
* вERDDAP™?[log.txt](/docs/server-admin/additional-information#log)Файл, вы увидите много "GC (Неудача распределения) "сообщения.
Обычно это не проблема. Это частое сообщение от нормально работающегоJavaОн сказал, что только что закончил небольшую коллекцию мусора, потому что в Эдеме не осталось места. (В этом разделеJavaКуча очень молодых предметов) . Обычно сообщение показывает вам _memoryUseBefore_\\-&gt;_memoryUseAfter_. Если эти два числа близки друг к другу, это означает, что сбор мусора не был продуктивным. Сообщение является лишь признаком неприятности, если оно очень частое. (каждые несколько секунд) , непродуктивные, и цифры большие и не растут, что в совокупности указывает на то, чтоJavaОн нуждается в большем количестве памяти, изо всех сил пытается освободить память и не может освободить память. Это может произойти во время стресса, а затем уйти. Но если оно сохранится, это будет признаком беды.
* Если вы видите java.lang.OutOfMemoryERDDAP™?[log.txt](/docs/server-admin/additional-information#log)Файл, см.[Ошибка OutOfMemory](/docs/server-admin/additional-information#outofmemoryerror)Советы о том, как диагностировать и решать проблемы.
         
### Разрешения{#permissions} 
*   [На Linux и Mac измените разрешения](#permissions)всех\\*.shфайлы в _tomcat_/bin/ для выполнения владельцем, например,
```
    chmod +x \\*.sh  
```
### Шрифты{#fonts} 
*   [Шрифты для изображений:](#fonts)Мы предпочитаем свободные[шрифты DejaVu](https://dejavu-fonts.github.io/)к другомуJavaшрифты. Использование этих шрифтов настоятельно рекомендуется, но не требуется.
    
Если вы решили не использовать шрифты DejaVu, вам нужно изменить настройку fontFamily в setup.xml на&lt;Разработчик:SansSerif&lt;/fontFamily&gt;, который доступен для всехJavaраспределения. Если вы установите fontFamily на имя шрифта, который недоступен,ERDDAP™Не загружается и печатает список доступных шрифтов в файле log.txt. Вы должны использовать один из этих шрифтов.
    
Если вы решите использовать шрифты DejaVu, убедитесь, что настройка fontFamily в setup.xml&lt;шрифт Разработчик:DejaVu Sans&lt;/fontFamily&gt;.
    
Чтобы установить шрифты DejaVu, пожалуйста, загрузите[ДежаВуФонты.zip](/DejaVuFonts.zip)  (5 522 795 байт, MD5=33E1E61FAB06A547851ED308B4FFEF42) и распаковывать файлы шрифтов во временный каталог.
    
    * На Linux:
        * Для Linux AdoptiumJavaРаспределение, см.[Эти инструкции](https://blog.adoptopenjdk.net/2021/01/prerequisites-for-font-support-in-adoptopenjdk/).
        * с другимиJavaРаспределение: Как пользователь Tomcat, скопируйте файлы шрифтов в _JAVA\\_HOME_/lib/fontsJavaВы можете найти шрифты. Помните: если позже вы перейдете на новую версиюJavaВам нужно переустановить эти шрифты.
    * На Mac: для каждого файла шрифта дважды нажмите на него, а затем нажмите «Установить шрифт».
    * В Windows 7 и 10: в Windows Explorer выберите все файлы шрифта. Прямой клик. Нажмите на Установка.
             
### Тестирование Tomcat{#test-tomcat} 
* Проверьте установку Tomcat.
    * Linux:
        * Как пользователь "tomcat", запустите _tomcat_/bin/startup.sh
        * Просмотр URL + ":8080/" в браузере (например,[ http://coastwatch.pfeg.noaa.gov:8080/ ](http://coastwatch.pfeg.noaa.gov:8080/)) .
        * Вы должны увидеть страницу «Поздравления» Tomcat.
Если есть проблемы, посмотрите файл журнала Tomcat _tomcat_/logs/catalina.out.
    * Мак (Run Tomcat как пользователь системного администратора) :
        * Run_tomcat_/bin/startup.sh
        * Просмотр URL + ":8080/" в браузере (например,[ http://coastwatch.pfeg.noaa.gov:8080/ ](http://coastwatch.pfeg.noaa.gov:8080/)) . Обратите внимание, что по умолчанию ваш Tomcat доступен только вам. Он не является общедоступным.
        * Вы должны увидеть страницу «Поздравления» Tomcat.
Если есть проблемы, посмотрите файл журнала Tomcat _tomcat_/logs/catalina.out.
    * Windows Localhost:
        
        * Правильно нажмите на значок Tomcat в системном лотоке и выберите «Начать обслуживание».
        * Посмотреть[ http://127.0.0.1:8080/ ](http://127.0.0.1:8080/)или, возможно,[ http://localhost:8080/ ](http://localhost:8080/)В вашем браузере. Обратите внимание, что по умолчанию ваш Tomcat доступен только вам. Он не является общедоступным.
        * Вы должны увидеть страницу «Поздравления» Tomcat.
Если есть проблемы, посмотрите файл журнала Tomcat _tomcat_/logs/catalina.out.
            
### Проблемы с установкой Tomcat?{#troubles-with-the-tomcat-installation} 
* На Linux и Mac, если вы не можете связаться с TomcatERDDAP™  (Или, возможно, вы просто не можете связаться с ними с компьютера за пределами вашего брандмауэра.) Вы можете проверить, слушает ли Tomcat порт 8080. (как корень) В командной строке сервера:
```  
    netstat -tuplen | grep 8080  
```
Это должно вернуть одну строку с чем-то вроде:
``` 
    tcp 0 0 :::8080 :::\\* LISTEN ## ##### ####/java
``` 
     (где «#» — некая цифра) Указывая, что процесс «джавы» (Предположительно Tomcat) Прослушивается на порту "8080" для "tcp" трафика. Если линии не были возвращены, если возвращенная линия значительно отличается или если были возвращены две или более линий, то может возникнуть проблема с настройками порта.
* Файл журнала Tomcat _tomcat_/logs/catalina.out. Проблемы с Tomcat и некоторые другиеERDDAP™Проблемы с запуском почти всегда указываются там. Это распространено, когда вы впервые создаетеERDDAP™.
* Видишь?[Томкат](https://tomcat.apache.org/)Веб-сайт или поиск в Интернете для помощи, но, пожалуйста, сообщите нам о проблемах, которые у вас были, и решениях, которые вы нашли.
* Увидеть наш[Раздел о дополнительной поддержке](/docs/intro#support).
             
### ERDDAP™Контент{#erddap-content} 
3.  [Настройка_tomcat_/content/erddapКонфигурационные файлы.](#erddap-content)  
На Linux, Mac и Windows, скачать[erddapContent.zip](https://github.com/ERDDAP/erddapContent/releases/download/content1.0.0/erddapContent.zip)  (версия 1.0.0, 20333 байт, MD5=2B8D2A5AE5ED73E3A42B529C168C60B5, датированная 2024-10-14) и распаковывать его в _tomcat_, создавая_tomcat_/content/erddap.

    \\[Также доступны некоторые предыдущие версии:
    [2.17](https://github.com/ERDDAP/erddap/releases/download/v2.17/erddapContent.zip)  (19 792 байта, MD5=8F892616BAEEF2DF0F4BB036DCB4AD7C, от 2022-02-16)   
    [2.18](https://github.com/ERDDAP/erddap/releases/download/v2.18/erddapContent.zip)  (19 792 байта, MD5=8F892616BAEEF2DF0F4BB036DCB4AD7C, от 2022-02-16)   
    [2.21](https://github.com/ERDDAP/erddap/releases/download/v2.21/erddapContent.zip)  (19 810 байт, MD5=1E26F62E7A06191EE6868C40B9A29362, от 2022-10-09)   
    [2.22](https://github.com/ERDDAP/erddap/releases/download/v2.22/erddapContent.zip)  (19 810 байт, MD5=1E26F62E7A06191EE6868C40B9A29362, от 2022-12-08) 
    [2.23](https://github.com/ERDDAP/erddap/releases/download/v2.23/erddapContent.zip)  (19 810 байт, MD5=1E26F62E7A06191EE6868C40B9A29362, от 2023-02-27) 
и распаковывать его в _tomcat_, создавая_tomcat_/content/erddap.\\]
    
#### Другая директория{#other-directory} 
Для Red Hat Enterprise Linux (Рейл) или для других ситуаций, когда вам не разрешено изменять каталог Tomcat или где вы хотите / должны разместитьERDDAP™Каталог контента в другом месте по другой причине (Например, если вы используете Jetty вместо Tomcat.) , unzip erddapContent.zipВ нужный каталог (Доступ к которой имеет только пользователь) и установитьerddapContentDirectoryСистема собственности (например,erddapContentDirectory=~tomcat/content/erddap) такERDDAP™Вы можете найти этот новый каталог контента.
    
### Настройка.xml{#setupxml} 
*   [Читайте комментарии в_tomcat_/content/erddap/ **Настройка.xml** ](#setupxml)и внести запрошенные изменения. setup.xml - это файл со всеми настройками, которые определяют, как выERDDAP™ведет себя.
Для первоначальной настройки вы должны по крайней мере изменить эти настройки:
```
    <bigParentDirectory>, <emailEverythingTo>, <baseUrl>, <email.\\*>, <admin.\\*> (and <baseHttpsUrl> when you set up https).
```
    
При создании BigParentDirectory из родительского каталога BigParentDirectory:
    
    * Сделать пользователя=tomcat владельцем большой родительской директории, например,
```
        chown -R tomcat _bigParentDirectory_
```
    * Измените «группу» на Tomcat, ваше имя пользователя или название небольшой группы, которая включает в себя Tomcat и всех администраторов Tomcat.ERDDAPНапример,
```
        chgrp -R _yourUserName_ _bigParentDirectory_
```
    * Изменяйте разрешения, чтобы Tomcat и группа читали, писали, выполняли привилегии.
```
        chmod -R ug+rwx _bigParentDirectory_
```
    * Удалите «другие» разрешения пользователя на чтение, запись или выполнение. Это важно для предотвращения чтения потенциально конфиденциальной информации.ERDDAP™Файлы журналов и файлы с информацией о частных наборах данных:
```
        chmod -R o-rwx _bigParentDirectory_
```

### Переменные среды{#environment-variables} 
Начиная сERDDAP™v2.13,ERDDAP™Администраторы могут переопределить любое значение в setup.xml, указав переменную среды, названнуюERDDAP\\__valueName_ перед запускомERDDAP™. Например, использоватьERDDAP\\_baseUrl перекрывает&lt;BaseUrl&gt; стоимость. Это может быть удобно при развертыванииERDDAP™с контейнером, таким как Docker, вы можете установить стандартные настройки в setup.xml, а затем предоставить специальные настройки через переменные среды. Если вы предоставляете секретную информациюERDDAP™С помощью этого метода убедитесь, что информация останется секретной.ERDDAP™считывает переменные среды только один раз на стартап, в первую секунду запуска, поэтому один из способов использовать это: установить переменные среды, начатьERDDAPПодожди, покаERDDAP™Запускается, затем отключаются переменные среды.
    
### datasets.xml {#datasetsxml} 
* Читайте комментарии в[ **Работая сdatasets.xmlФайл** ](/docs/server-admin/datasets). Позже, когда ты получишьERDDAP™Бег в первый раз (Обычно только с наборами данных по умолчанию) Вы будете изменять XML в_tomcat_/content/erddap/ **datasets.xml** указать все наборы данных, которые вы хотитеERDDAP™служить. Именно здесь вы будете тратить большую часть своего времени на настройку.ERDDAP™А потом, сохраняя свойERDDAP™.

Вы можете увидеть пример[datasets.xmlНа GitHub](https://github.com/ERDDAP/erddap/blob/main/development/jetty/config/datasets.xml).
     
*    (маловероятно) Сейчас или (немного вероятнее) Если вы хотите изменить CSS-файл erddap, сделайте копию_tomcat_/content/erddap/images/erddapStart2.css называется erddap2.css и затем вносит в него изменения. Изменения в erddap2.css вступают в силу только тогда, когдаERDDAP™Перезапускается и часто требует от пользователя очистить кэшированные файлы браузера.
     
ERDDAP™не будет работать правильно, если setup.xml илиdatasets.xmlФайл не является хорошо сформированным XML-файлом. Таким образом, после редактирования этих файлов рекомендуется проверить, что результат хорошо сформирован XML, вставив текст XML в XML-проверку.[xmlvalidation](https://www.xmlvalidation.com/).
     
### Установите файл erddap.war{#install-the-erddapwar-file} 
4. На Linux, Mac и Windows, скачать[erddap.war](https://github.com/ERDDAP/erddap/releases/download/v2.27.0/erddap.war)_tomcat_/webapps.
     (версия 2.27.0, 620,554,403 байт, MD5=3b2086c659eee4145ca2dff447bf4ef7, датированная 06-11-2025) 
    
Военный файл большой, потому что он содержит данные о береговой линии, границе и высоте высокого разрешения, необходимые для создания карт.
    
    \\[Также доступны некоторые предыдущие версии.
    [2.17](https://github.com/ERDDAP/erddap/releases/download/v2.17/erddap.war)  (551 068 245 байт, MD5=5FEA912B5D42E50EAB9591F773EA848D, от 2022-02-16)   
    [2.18](https://github.com/ERDDAP/erddap/releases/download/v2.18/erddap.war)  (551 069 844 байт, MD5=461325E97E7577EC671DD50246CCFB8B, от 2022-02-23)   
    [2.21](https://github.com/ERDDAP/erddap/releases/download/v2.21/erddap.war)  (568 644 411 байт, MD5=F2CFF805893146E932E498FDDBD519B6, от 2022-10-09)   
    [2.22](https://github.com/ERDDAP/erddap/releases/download/v2.22/erddap.war)  (567 742 765 байт, MD5=2B33354F633294213AE2AFDDCF4DA6D0, от 2022-12-08) 
    [2.23](https://github.com/ERDDAP/erddap/releases/download/v2.23/erddap.war)  (572 124 953 байт, MD5=D843A043C506725EBD6F8EFDCCA8FD5F, от 2023-03-03) 
    [2.24](https://github.com/ERDDAP/erddap/releases/download/v2.24/erddap.war)  (568 748 187 байт, MD5=970fbee172e28b0b8a07756eecbc898e, от 2024-06-07) 
    [2.25](https://github.com/ERDDAP/erddap/releases/download/v2.25.1/erddap.war)  (592 292 039 байт, MD5=652AFC9D1421F00B5F789DA2C4732D4C, от 2024-11-07) 
    [2.26](https://github.com/ERDDAP/erddap/releases/download/v2.26.0/erddap.war)  (607 404 032 байт, MD5=99a725108b37708e5420986c1616a119, от 2025-03-31) 
    \\]
    
#### Проксипасс{#proxypass} 
5. Используйте Proxy Пройдите, чтобы пользователям не приходилось указывать номер порта, например:8080, в URL.
На компьютерах Linux, если Tomcat работает в Apache, пожалуйста, измените Apache.httpd.conf файл (обычно в /etc/httpd/conf/) Позволять HTTP-трафику в/изERDDAP™без указания номера порта, например:8080, в URL. Как корневой пользователь:
    1. Изменить существующий&lt;VirtualHost&gt; Tag (Если есть один) или добавить в конце файла:
```
        <VirtualHost \\*:80>
           ServerName _YourDomain.org_
           ProxyRequests Off
           ProxyPreserveHost On
           ProxyPass /erddap http://localhost:8080/erddap
           ProxyPassReverse /erddap http://localhost:8080/erddap
        </VirtualHost>
```
    2. Перезапуск Apache: /usr/sbin/apachectl -к грациозный (Но иногда он находится в другом каталоге.) .
         
### NGINX{#nginx} 
 (UNCOММОН) Если вы используете[NGINX](https://www.nginx.com/)  (Веб-сервер и балансировщик нагрузки) :
Чтобы получить NGINX иERDDAP™правильно работать сhttps, вы должны поместить следующий фрагмент внутри Tomcat server.xml&lt;Host&gt; блок:
```
    &lt;Valve className="org.apache.catalina.valves.RemoteIpValve"  
      remoteIpHeader="X-Forwarded-For"  
      protocolHeader="X-Forwarded-Proto"  
      protocolHeaderHttpsValue="https" /&gt; 
```
А в файле конфигурирования nginx нужно установить эти заголовки:
```
      proxy\\_set\\_header Host              $host;
      proxy\\_set\\_header X-Real-IP         $remote\\_addr;
      proxy\\_set\\_header REMOTE\\_ADDR       $remote\\_addr;
      proxy\\_set\\_header HTTP\\_CLIENT\\_IP    $remote\\_addr;
      proxy\\_set\\_header X-Forwarded-For   $proxy\\_add\\_x\\_forwarded\\_for;
      proxy\\_set\\_header X-Forwarded-Proto $scheme;
```
 (Спасибо Кайлу Уилкоксу.)   
     
### Начать Tomcat{#start-tomcat} 
*    (Я не рекомендую использовать Tomcat Web Application Manager. Если вы не полностью отключите и не запустите Tomcat, рано или поздно у вас будут проблемы с памятью PermGen.)   
     
*    (В Linux или Mac OS, если вы создали специального пользователя для запуска Tomcat, например, Tomcat, не забудьте выполнить следующие действия в качестве этого пользователя.)   
     
* Если Tomcat уже работает, закройте Tomcat. (Linux или Mac OS) _tomcat_/bin/shutdown.sh
или (В Windows) _tomcat_\\bin\\shutdown.bat
    
Для Linux используйте ps-ef|grep tomcat до и после shutdown.sh, чтобы убедиться, что процесс Tomcat остановился. Процесс должен быть указан до отключения и в конечном итоге не указан после отключения. Это может занять минуту или две дляERDDAP™полностью закрыться. Будь терпелив. Или если кажется, что он не остановится сам по себе, используйте:
Убить -9 _processID_
    
* Начните с Tomcat (Linux или Mac OS) _tomcat_/bin/startup.sh
или (В Windows) _tomcat_\\bin\\startup.bat

## этоERDDAP™бегать?{#is-erddap-running} 
Используйте браузер, чтобы попытаться просмотреть http://_www.YourServer.org_/erddap/status.html   
ERDDAP™Запускается без загрузки наборов данных. Наборы данных загружаются в фоновый поток и поэтому становятся доступными один за другим.

### устранение неполадок{#troubleshooting} 
* Когда приходит запрос от пользователя, он переходит в Apache. (на компьютерах Linux и Mac OS) Потом Томкэт, потомERDDAP™.
* Вы можете увидеть, что происходит с Apache. (и связанных с ними ошибок) в файлах журнала Apache.
*   [Ты](/docs/server-admin/additional-information#tomcat-logs)Посмотрим, что будет с Tomcat (и связанных с ними ошибок) в файлах журнала Tomcat (_tomcat_/logs/catalina.out и другие файлы в этом каталоге) .
*   [Ты](/docs/server-admin/additional-information#log)Увидеть, что приходитERDDAPдиагностические сообщения отERDDAPСообщения об ошибках отERDDAPвERDDAP™ &lt;bigParentDirectory&gt;logs/log.txt файл.
* Tomcat не запускаетсяERDDAP™Пока Томкэт не получит запросERDDAP™. Так что вы можете увидеть в файлах журнала Tomcat, если это началось.ERDDAP™или если есть сообщение об ошибке, связанное с этой попыткой.
* КогдаERDDAP™Начинается, переименовывает староеERDDAP™log.txt файл (logArchivedAt_CurrentTime_.txt) Создает новый файл log.txt. Так что если бревно. Файл txt старый, это признак того, чтоERDDAP™Недавно не перезапустили.ERDDAP™записывает информацию журнала в буфер и только периодически записывает буфер в файл журнала, но вы можете заставитьERDDAP™Записать буфер в файл журнала, посетив.../erddap/status.html.

### Проблема: старая версияJava {#trouble-old-version-of-java} 
Если вы используете версиюJavaЭто слишком старо дляERDDAP,ERDDAP™Вы не запустите и увидите сообщение об ошибке в файле журнала Tomcat.
Исключение в потоке "основной" java.lang.UnsupportedClassVersionError:
_some/class/name_: Неподдерживаемая версия major.minor_someNumber_
Решение заключается в обновлении до последней версииJavaИ убедись, что Томкэт использует его.

### Проблема: медленный запуск в первый раз{#trouble-slow-startup-first-time} 
Tomcat должен сделать много работы в первый раз, когда приложениеERDDAP™Запускается; в частности, он должен распаковать erddap. военный файл (который похож на.zipфайл) . На некоторых серверах первая попытка просмотраERDDAP™ларьки (30 секунд?) Пока эта работа не будет завершена. На других серверах первая попытка сразу же провалится. Но если вы подождите 30 секунд и попробуете еще раз, это будет иметь успех.ERDDAP™был установлен правильно.
Для этого нет никакого решения. Именно так работает Tomcat. Но это происходит только в первый раз после установки новой версии.ERDDAP™.

## Закрыть и перезапустить{#shut-down-and-restart} 
В будущем закрыть (и возобновить)  ERDDAPВидишь?[Как закрыть и перезапустить TomcatERDDAP](/docs/server-admin/additional-information#shut-down-and-restart).
## Проблемы?{#trouble} 
Проблемы с установкой Tomcat илиERDDAP? Увидеть наш[Раздел о дополнительной поддержке](/docs/intro#support).
## Уведомление по электронной почте о новых версияхERDDAP {#email-notification-of-new-versions-of-erddap} 
Если вы хотите получать электронное письмо каждый раз, когда новая версияERDDAP™Доступны или другие важныеERDDAP™Объявления, вы можете присоединиться кERDDAP™Список объявлений[здесь](https://groups.google.com/g/erddap-announce). Этот список в среднем составляет примерно одно электронное письмо каждые три месяца.
## настраивать{#customize} 
[Настроить свойERDDAP™Чтобы подчеркнуть вашу организацию (неNOAA ERD) .](#customize)
    * Измените баннер, который появляется в верхней частиERDDAP™.html страницы путем редактирования&lt;startBodyHtml5&gt; тег на вашем сайтеdatasets.xmlФайл. (Если нет, скопируйте по умолчанию изERDDAP?
        \\[кот\\]/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml файлdatasets.xmlи редактировать его. Например, вы можете:
        * Используйте другое изображение (Логотип вашей организации) .
        * Измените цвет фона.
        * Переоденься.ERDDAP«Ваша организация»ERDDAP"
        * Изменить «Упрощенный доступ к научным данным» на «Упрощенный доступ к данным вашей организации».
        * Измените ссылки «Принесено вам», чтобы они были ссылками на вашу организацию и источники финансирования.
    * Измените информацию на левой стороне главной страницы, отредактировав&lt;ShortDescriptionHtml&gt; тег в вашемdatasets.xmlФайл. (Если нет, скопируйте по умолчанию изERDDAP?
        \\[кот\\]/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml файлdatasets.xmlи редактировать его. Например, вы можете:
        * Опишите, чем занимается ваша организация и/или группа.
        * Опишите, какие данные этоERDDAP™Есть.
    * Чтобы изменить значок, который появляется на вкладках браузера, поместите favicon вашей организации. ико в_tomcat_/content/erddap/изображения/. Видишь?[ https://en.wikipedia.org/wiki/Favicon ](https://en.wikipedia.org/wiki/Favicon).
