---
sidebar_position: 1
---

# устанавливать
Как сделать начальную настройку ERDDAP™ На вашем сервере

 ERDDAP™ Может работать на любом сервере, который поддерживает Java и Tomcat (и другие серверы приложений, такие как Jetty, но мы не поддерживаем их) .
 ERDDAP™ Проверено на Linux (В том числе на Amazon AWS) Компьютеры Mac и Windows.

*  **Докер** - Мы предоставляем [ ERDDAP™ В контейнере Docker](https://hub.docker.com/r/erddap/erddap) 
IOOS теперь предлагает [Руководство для быстрого старта ERDDAP™ В контейнере Docker](https://ioos.github.io/erddap-gold-standard/index.html) .
Это стандарт ERDDAP™ Установка в контейнере Docker.
Через Docker Сочиняем мы предлагаем простые способы настройки Ssl и мониторинга, читайте дальше [Документация Docker](https://github.com/ERDDAP/erddap/blob/main/DOCKER.md) .
Если вы уже используете Docker, вы, вероятно, предпочтете версию Docker.
Если вы хотите работать на облачных сервисах, вы, вероятно, предпочтете версию Docker.
*  **Amazon** - Если вы устанавливаете ERDDAP™ На примере Amazon Web Services EC2 см. [Обзор веб-сервисов Amazon](/docs/server-admin/additional-information#amazon) Сначала.
*  **Linux и Mac** - ERDDAP™ Отлично работает на компьютерах Linux и Mac. Смотрите инструкции ниже.
*  **Windows** - Windows отлично подходит для тестирования ERDDAP™ и для личного использования (Смотрите инструкции ниже) ,
Но мы не рекомендуем использовать его для общественности. ERDDAP™ развертывания. бегать ERDDAP™ В Windows могут возникнуть проблемы:
В частности, ERDDAP™ Может быть невозможно быстро удалить и/или переименовать файлы. Вероятно, это связано с антивирусным программным обеспечением.
   (Например, от McAfee и Norton) Проверка файлов на наличие вирусов. Если вы столкнулись с этой проблемой
(что можно увидеть по сообщениям об ошибках) [log.txt](/docs/server-admin/additional-information#log) файл как
«Невозможность удалить ...», изменение настроек антивирусного программного обеспечения может частично облегчить проблему. Или подумайте об использовании сервера Linux или Mac.

 **Стандарт ERDDAP™ Инструкции по установке для компьютеров Linux, Mac и Windows:** 

0. Убедитесь, что все зависимости установлены. На машинах без Windows (Linux и Mac) Вам нужен CSH.

##  Java  {#java} 

1.  [Для ERDDAP™ v2.19+, установленный Java 21.](#java) 
По соображениям безопасности почти всегда лучше использовать последнюю версию. Java 21.
Пожалуйста, загрузите и установите последнюю версию
    [Открытый JDK (Темурин) 21 (LTS) ](https://adoptium.net/temurin/releases/?version=21) .
Чтобы проверить установку, запустите `/javaJreBinDirectory/java инверсия` Например,
    `/usr/local/jdk-21.0.3+9/jre/bin/java инверсия` .

    ERDDAP™ работать с Java из других источников, но мы рекомендуем Адоптий, потому что он является основным, поддерживаемым сообществом,
свободный (Как в пиве и речи) версия Java 21 Долгосрочная поддержка (Бесплатные обновления в течение многих лет после первоначального выпуска) .
По соображениям безопасности, пожалуйста, обновите ERDDAP версия Java периодически в виде новых версий Java 21 Стать доступным из Adoptium.

    ERDDAP™ Он был протестирован и широко использовался с 21, а не с другими версиями. По разным причинам мы не тестируем и не поддерживаем другие версии. Java .
     
## Томкат{#tomcat} 

2.  [Настройка](#tomcat)   [Томкат](https://tomcat.apache.org) . Tomcat является наиболее широко используемым Java Сервер приложений,
который является Java программное обеспечение, которое находится между сетевыми службами операционной системы и Java Серверное программное обеспечение как ERDDAP™ .
Бесплатное и открытое программное обеспечение (Фосс) .

Вы можете использовать другой Java Сервер приложений (Например, Jetty) Мы тестируем и поддерживаем только Tomcat.

   * Загрузите Tomcat и распакуйте его на своем сервере или ПК.
Из соображений безопасности лучше всего использовать последнюю версию Tomcat 10. (Версия 9 и ниже не приемлемы.) 
который предназначен для работы с Java 21 или больше. Ниже каталог Tomcat будет называться `кот` .

Предупреждение&#33;__ Если у вас уже есть Tomcat с другим веб-приложением (Особенно дреды) Мы рекомендуем вам установить ERDDAP™ в
      [Второй Tomcat](/docs/server-admin/additional-information#second-tomcat) Потому что ERDDAP™ Нужны разные настройки Tomcat
И не нужно бороться с другими приложениями для памяти.

     * На Linux, [Скачать «Core» «tar» .gz Распределение "Томкат"](https://tomcat.apache.org/download-10.cgi) и распаковать его.
Рекомендуем распаковать его в `/usr/local` .
     * На Mac Tomcat, вероятно, уже установлена `Библиотека / Tomcat` Обновление до последней версии Tomcat 10.
Если вы загрузите его, [Скачать «Core» «tar» .gz Распределение "Томкат"](https://tomcat.apache.org/download-10.cgi) и распаковать его в `Библиотека / Tomcat` .
     * В Windows вы можете [Скачать дистрибутив «Core» «zip» Tomcat](https://tomcat.apache.org/download-10.cgi) 
        (который не имеет проблем с реестром Windows и который вы контролируете из командной строки DOS) и распаковать его в соответствующем каталоге.
        (Для разработки мы используем дистрибутив «Core» «zip». Мы делаем `/программы` каталог и распаковать его там.) 
Или вы можете скачать «Core» «64-битный Windows zip» дистрибутив, который включает в себя больше функций.
Если дистрибутив является установщиком Windows, он, вероятно, поместит Tomcat, например. `/Программные файлы/apache-tomcat-10.0.23` .
             
### server.xml{#serverxml} 

*  [server.xml](#serverxml) - В этом `Tomcat/conf/server.xml` Файл, есть два изменения, которые вы должны сделать для каждого из двух ` <Connector> ` метки
   (для одного `&lt;Connector port="8080"` и один для `&lt;Conector port="8443"` ) .
   1.  (рекомендованный) увеличить `соединение тайм-аут` значение параметра, возможно, до 300000 (миллисекунды, что составляет 5 минут) .
   2.  (рекомендованный) Добавить новый параметр: `RelaxedQueryChars[править править код] | "` . Это необязательно и немного менее безопасно.
Но устраняет необходимость в том, чтобы пользователи кодировали эти символы, когда они возникают в параметрах URL-адреса запроса пользователя.
             
### Content.xml{#contentxml} 

* context.xml - Ресурсы кэша - в `Tomcat/conf/context.xml` Прямо перед тем, как ` </Context> ` Тег, изменить тег ресурсов
   (или добавить его, если его еще нет) Чтобы установить кэш Параметр MaxSize 80000:
  ```
  <Resources cachingAllowed="true" cacheMaxSize="80000" />
  ```
Это позволяет избежать многочисленных предупреждений при каталине. Все начинается с
  ```
  WARNING [main] org.apache.catalina.webresources.Cache.getResource Unable to add the resource at [/WEB-INF/classes/...]
  ```
         
### Apache Timeout{#apache-timeout} 

* На компьютерах Linux измените настройки тайм-аута Apache, чтобы отнимающие много времени запросы пользователей не отставали.
   (часто появляется как ошибка «Прокси» или «Плохой шлюз») . Как корневой пользователь:
  * Модифицировать Apache ` http d-conf` файл (обычно в `/etc/ http d/conf/` ) :
    * Изменить существующее ` <Timeout> ` устанавливать (Добавить в конце файла) до 3600 (секунды) Вместо стандартных 60 или 120 секунд.
    * Изменить существующее ` <ProxyTimeout> ` устанавливать (Добавить в конце файла) до 3600 (секунды) Вместо стандартных 60 или 120 секунд.
  * Перезапуск Apache: `/usr/sbin/apachectl -к грациозный`   (Но иногда он находится в другом каталоге.) .

### Безопасность{#security} 
         
* Рекомендация по безопасности: Видишь? [Эти инструкции](https://tomcat.apache.org/tomcat-10.0-doc/security-howto.html) Для повышения безопасности
Установка Tomcat, особенно для публичных серверов.
         
* Для публики ERDDAP™ Установки на Linux и Mac, лучше всего настроить Tomcat (Программа) как принадлежащий пользователю `кот` 
   (отдельный пользователь с ограниченными правами и [Пароль отсутствует](https://unix.stackexchange.com/questions/56765/creating-an-user-without-a-password) ) .
Таким образом, только суперпользователь может переключиться на действия в качестве пользователя. `кот` . Это делает невозможным для хакеров вход на ваш сервер в качестве пользователя. `кот` .
В любом случае, вы должны сделать так, чтобы `кот` Пользователь имеет очень ограниченные разрешения на файловую систему сервера (привилегии чтения + записи + выполнения)
для `апач-томкат` дерево каталогов и ` <bigParentDirectory> ` Привилегии только для чтения для каталогов с данными, которые ERDDAP™ Нужен доступ.
  * Вы можете создать `кот` учетная запись пользователя (который не имеет пароля) Используя команду:
    ```
    sudo useradd tomcat -s /bin/bash -p '*'
    ```
  * Вы можете перейти на работу в качестве пользователя `кот` Используя команду
    ```
    sudo su - tomcat
    ```
     (Он попросит у вас пароль суперпользователя для разрешения на это.) 
    * Вы можете перестать работать как пользователь Tomcat, используя команду
    ```
    exit
    ````
    * Выполняйте большую часть работы и ERDDAP™ Инструкции настройки как пользователь `кот` . Позже, запустите `Startup.sh` и `Отключение. рубить` скрипты как пользователь `кот` 
Чтобы у Tomcat было разрешение записывать в свои файлы журналов.
    * После распаковки Tomcat, от родителя `апач-томкат` Каталог:
      * Измените право собственности на дерево каталогов apache-tomcat для пользователя томата.
        ```
        chown -R tomcat apache-tomcat-10.0.23
        ```
         (Замените фактическое имя вашего каталога Tomcat) .
      * Измените «группу» на Tomcat, ваше имя пользователя или название небольшой группы, которая включает в себя Tomcat и всех администраторов Tomcat. ERDDAP :
        ```
        chgrp -R yourUserName apache-tomcat-10.0.23
        ```
      * Измените разрешения так, чтобы Tomcat и группа читали, писали, выполняли привилегии:
        ```
        chmod -R ug+rwx apache-tomcat-10.0.23
        ```
      * Удалите «другие» разрешения пользователя на чтение, запись или выполнение:
        ```
        chmod -R o-rwx apache-tomcat-10.0.23
        ```
Это важно, потому что это мешает другим пользователям читать потенциально конфиденциальную информацию. ERDDAP™ Настройка файлов.

### Память{#memory} 

Переменные среды Tomcat

* Linux и Mac:
Создайте файл `Tomcat/bin/setenv.sh`   (В Red Hat Enterprise Linux \\[ Рейл \\] Редактировать `-omcat/conf/tomcat10.conf` ) Установить переменные среды Tomcat.
Этот файл будет использоваться `Tomcat/bin/startup.sh` и `Отключение. рубить` . Файл должен содержать что-то вроде:
  ```
  export JAVA_HOME=/usr/local/jdk-21.0.3+9
  export JAVA_OPTS='-server -Djava.awt.headless=true -Xmx1500M -Xms1500M'
  export TOMCAT_HOME=/usr/local/apache-tomcat-10.0.23
  export CATALINA_HOME=/usr/local/apache-tomcat-10.0.23
  ```
   (Замените имена каталогов с вашего компьютера) .
   (Если вы ранее установили `JRE_HOME` Вы можете удалить это.) 
На Mac, вам, вероятно, не нужно устанавливать `ДЖАВА_ДОМ` .

* В Windows:
Создайте файл `Tomcat\bin\\setenv.bat` Установить переменные среды Tomcat.
Этот файл будет использоваться `Tomcat\bin\\startup.bat` и ` shutdown.bat ` .
Файл должен содержать что-то вроде:
  ```
  SET "JAVA_HOME=\\someDirectory\\jdk-21.0.3+9"
  SET "JAVA_OPTS=-server -Xmx1500M -Xms1500M"
  SET "TOMCAT_HOME=\\Program Files\\apache-tomcat-10.0.23"
  SET "CATALINA_HOME=\\Program Files\\apache-tomcat-10.0.23"
  ```
   (Замените имена каталогов с вашего компьютера) .
Если это только для локального тестирования, удалите «-сервер».
   (Если вы ранее установили `JRE_HOME` Вы можете удалить это.) 

The `Xmx` и `-Xms` Настройки памяти важны, потому что ERDDAP™ Лучше работать с большей памятью.
Всегда готов `-Xms` на ту же величину, что и `Xmx` .

* Для 32-битных операционных систем и 32-битных Java :
64 бит Java Гораздо лучше, чем 32 бит Java Но 32 бит Java Работает до тех пор, пока сервер не занят.
Чем больше физической памяти на сервере, тем лучше: 4+ ГБ - это действительно хорошо, 2 ГБ - это нормально, меньше не рекомендуется.
32-битный Java Даже с обильной физической памятью, Tomcat и Java не будет работать, если вы попытаетесь установить `Xmx` намного выше 1500 мкм (1200 М на некоторых компьютерах) .
Если ваш сервер имеет менее 2 ГБ памяти, уменьшите объем памяти. `Xmx` ценность (Исполнитель: 'M'egaBytes) 1/2 физической памяти компьютера.

* Для 64-битных операционных систем и 64-битных Java :
64 бит Java Работает только на 64-битной операционной системе.
  * с Java 8, нужно добавить `-d64` Для Tomcat `CATALINA_OPTS` параметр в `setenv.bat` .
  * с Java 21, выберите 64 бит Java Когда вы загружаете версию Java Помечено "64 бит".

64-битный Java Томкэт и Java Может использоваться очень высоко `Xmx` и `-Xms` настройки. Чем больше физической памяти на сервере, тем лучше.
В качестве упрощенного предложения: рекомендуем установить `Xmx` и `-Xms` то (Исполнитель: 'M'egaBytes) до 1/2 (менее) Физическая память компьютера.
Посмотрим, Томкэт ли, Java и ERDDAP™ Действительно работает в 64-битном режиме, ища «бит», в ERDDAP Электронная почта Daily Report
или в `BigParentDirectory/logs/ [log.txt](/docs/server-admin/additional-information#log) ` файл ( `BigParent Директория` указывается в [Настройка.xml](#setupxml) ) .

#### Коллекция Garbage{#garbage-collection} 

* в ERDDAP™ ? [log.txt](/docs/server-admin/additional-information#log) Файл, вы увидите много "GC (Неудача распределения) "сообщения.
Обычно это не проблема. Это частое сообщение от нормально работающего Java Говорят, что только что закончился небольшой мусор
Коллекция, потому что в Эдеме кончилось место (В этом разделе Java Куча очень молодых предметов) . Обычно сообщение показывает
   `ПамятьПосле` . Если эти два числа близки друг к другу, это означает, что сбор мусора не был продуктивным.
Сообщение является лишь признаком неприятности, если оно очень частое. (каждые несколько секунд) непродуктивными, а их число велико и не растет;
которые вместе указывают на то, что Java Он нуждается в большем количестве памяти, изо всех сил пытается освободить память и не может освободить память.
Это может произойти во время стресса, а затем уйти. Но если оно сохранится, это будет признаком беды.
* Если вы видите `java.lang.OutOfMemory` в ERDDAP™ ? [log.txt](/docs/server-admin/additional-information#log) файл,
смотреть [Ошибка OutOfMemory](/docs/server-admin/additional-information#outofmemoryerror) Советы о том, как диагностировать и решать проблемы.
         
### Разрешения{#permissions} 

*  [На Linux и Mac измените разрешения](#permissions) всех `*Ш.` файлы в `Томкат/бин/` быть выполнены владельцем:
  ```
  chmod +x *.sh
  ```

### Шрифты{#fonts} 

*  [Шрифты для изображений:](#fonts) Мы предпочитаем свободные [шрифты DejaVu](https://dejavu-fonts.github.io/) к другому Java шрифты.
Использование этих шрифтов настоятельно рекомендуется, но не требуется.

Если вы решили не использовать шрифты DejaVu, вам нужно изменить настройку fontFamily в setup.xml на ` <fontFamily> Сан-Сериф </fontFamily> ` ,
который доступен всем Java распределения. Если вы установили ` <fontFamily> ` к имени шрифта, который недоступен, ERDDAP™ не будет загружаться
и распечатает список доступных шрифтов в `log.txt` Файл. Вы должны использовать один из этих шрифтов.

Если вы решите использовать шрифты DejaVu, пожалуйста, убедитесь, что ` <fontFamily> ` Настройка setup.xml ` <fontFamily> Дежаву Санс </fontFamily> ` .

Чтобы установить шрифты DejaVu, пожалуйста, загрузите [ДежаВуФонты .zip ](/DejaVuFonts.zip)   (5 522 795 байт, MD5=33E1E61FAB06A547851ED308B4FFEF42) 
и распаковывать файлы шрифтов во временный каталог.

  * На Linux:
    * Для Linux Adoptium Java Распределение, см. [Эти инструкции](https://blog.adoptopenjdk.net/2021/01/prerequisites-for-font-support-in-adoptopenjdk/) .
    * с другими Java Распределение: Как и `кот` Пользователь, скопируйте файлы шрифта в `$JAVA_HOME/lib/fonts` так Java Вы можете найти шрифты.
Помните: если позже вы перейдете на новую версию Java Вам нужно переустановить эти шрифты.
  * На Mac: для каждого файла шрифта дважды нажмите на него, а затем нажмите «Установить шрифт».
  * В Windows 7 и 10: в Windows Explorer выберите все файлы шрифта. Прямой клик. Нажмите на Установка.
             
### Тестирование Tomcat{#test-tomcat} 

* Проверьте установку Tomcat.
  * Linux:
    * Как пользователь "tomcat", запустите `Tomcat/bin/startup.sh` .
    * Просмотр URL + ":8080/" в браузере (например, [http://coastwatch.pfeg.noaa.gov:8080/](http://coastwatch.pfeg.noaa.gov:8080/) ) .
  * Мак (Run Tomcat как пользователь системного администратора) :
    * Беги. `Tomcat/bin/startup.sh` .
    * Просмотр URL + ":8080/" в браузере (например, [http://coastwatch.pfeg.noaa.gov:8080/](http://coastwatch.pfeg.noaa.gov:8080/) ) .
Обратите внимание, что по умолчанию ваш Tomcat доступен только вам. Он не является общедоступным.
  * Windows Localhost:
    * Правильно нажмите на значок Tomcat в системном лотоке и выберите «Начать обслуживание».
    * Посмотреть [http://127.0.0.1:8080/](http://127.0.0.1:8080/) или, возможно, [http://localhost:8080/](http://localhost:8080/) В вашем браузере. Обратите внимание, что по умолчанию ваш Tomcat доступен только вам. Он не является общедоступным.

Вы должны увидеть страницу «Поздравления» Tomcat.

Если есть проблемы, посмотрите файл журнала Tomcat `tomcat/logs/catalina.out` .

### Проблемы с установкой Tomcat?{#troubles-with-the-tomcat-installation} 

* На Linux и Mac, если вы не можете связаться с Tomcat ERDDAP™   (Или, возможно, вы просто не можете связаться с ними с компьютера за пределами вашего брандмауэра.) ,
Вы можете проверить, слушает ли Tomcat порт 8080. (как корень) В командной строке сервера:

  ```
  netstat -tuplen | grep 8080
  ```

Это должно вернуть одну строку с чем-то вроде:

  ```
  tcp 0 0 :::8080 :::* LISTEN ## ##### ####/java
  ```

   (где `#` Это какая-то цифра) Указывая, что a `ява` процесс (Предположительно Tomcat) Прослушивается на порту "8080" для "tcp" трафика.
Если линии не были возвращены, если возвращенная линия значительно отличается или если были возвращены две или более линий, то может возникнуть проблема с настройками порта.

* Посмотреть файл журнала Tomcat `tomcat/logs/catalina.out` . Проблемы с Tomcat и некоторые другие ERDDAP™ Проблемы с запуском почти всегда указываются там.
Это распространено, когда вы впервые создаете ERDDAP™ .

* Видишь? [Томкат](https://tomcat.apache.org/) Веб-сайт или поиск в Интернете для помощи, но, пожалуйста, сообщите нам о проблемах, которые у вас были, и решениях, которые вы нашли.

* Увидеть наш [Раздел о дополнительной поддержке](/docs/intro#support) .
             
###  ERDDAP™ Контент{#erddap-content} 
3.   [Настройка `Tomcat/content/erddap` Конфигурационные файлы.](#erddap-content) 
На Linux, Mac и Windows, скачать [erddapContent .zip ](https://github.com/ERDDAP/erddapContent/releases/download/content1.0.0/erddapContent.zip) 
и разъединить его в `кот` каталог, создавая `Tomcat/content/erddap` .

__Версия 1.0.0, 20333 байт, MD5=2B8D2A5AE5ED73E3A42B529C168C60B5, датированная 2024-10-14__

Также доступны некоторые предыдущие версии:

    *  [2.17](https://github.com/ERDDAP/erddap/releases/download/v2.17/erddapContent.zip)   (19 792 байта, MD5=8F892616BAEEF2DF0F4BB036DCB4AD7C, от 2022-02-16) 
    *  [2.18](https://github.com/ERDDAP/erddap/releases/download/v2.18/erddapContent.zip)   (19 792 байта, MD5=8F892616BAEEF2DF0F4BB036DCB4AD7C, от 2022-02-16) 
    *  [2.21](https://github.com/ERDDAP/erddap/releases/download/v2.21/erddapContent.zip)   (19 810 байт, MD5=1E26F62E7A06191EE6868C40B9A29362, от 2022-10-09) 
    *  [2.22](https://github.com/ERDDAP/erddap/releases/download/v2.22/erddapContent.zip)   (19 810 байт, MD5=1E26F62E7A06191EE6868C40B9A29362, от 2022-12-08) 
    *  [2.23](https://github.com/ERDDAP/erddap/releases/download/v2.23/erddapContent.zip)   (19 810 байт, MD5=1E26F62E7A06191EE6868C40B9A29362, от 2023-02-27) 

#### Другая директория{#other-directory} 

Для Red Hat Enterprise Linux (Рейл) или для других ситуаций, когда вам не разрешено изменять каталог Tomcat или где вы хотите / нуждаетесь
Чтобы положить ERDDAP™ Каталог контента в другом месте по другой причине (Например, если вы используете Jetty вместо Tomcat.) ,
отключать `erddapContent .zip ` В нужный каталог (которой только `кот` Пользователь имеет доступ) и установить ` erddapContentDirectory ` Система собственности
 (Например. ` erddapContentDirectory  =~tomcat/content/erddap ` ) так ERDDAP™ Вы можете найти этот новый каталог контента.

### Настройка.xml{#setupxml} 

*  [Читайте комментарии в `tomcat/content/erddap/setup.xml` ](#setupxml) и внести запрошенные изменения. setup.xml - это файл со всеми настройками, которые определяют, как вы ERDDAP™ ведет себя.

Для первоначальной настройки вы должны по крайней мере изменить эти настройки:
      *  ` <bigParentDirectory> ` 
      *  ` <emailEverythingTo> ` 
      *  ` <baseUrl> ` 
      *  ` <email...> ` настройки
      *  ` <admin...> ` настройки
      *  ` <baseHttpsUrl> `   (Когда вы устанавливаете https ) 

При создании BigParentDirectory из родительского каталога BigParentDirectory:

    * Сделать `кот` пользователь, владелец `BigParent Директория` :
      ```
      chown -R tomcat bigParentDirectory
      ```
    * Измените «группу» на Tomcat, ваше имя пользователя или название небольшой группы, которая включает в себя Tomcat и всех администраторов Tomcat. ERDDAP :
      ```
      chgrp -R yourUserName bigParentDirectory
      ```
    * Измените разрешения так, чтобы Tomcat и группа читали, писали, выполняли привилегии:
      ```
      chmod -R ug+rwx bigParentDirectory
      ```
    * Удалите «другие» разрешения пользователя на чтение, запись или выполнение. Это важно для предотвращения чтения потенциально конфиденциальной информации.
в ERDDAP™ Файлы журналов и файлы с информацией о частных наборах данных.
      ```
      chmod -R o-rwx bigParentDirectory
      ```

### Переменные среды{#environment-variables} 

Начиная с ERDDAP™ v2.13, ERDDAP™ Администраторы могут переопределить любое значение в setup.xml, указав переменную среды.
названный ` ERDDAP _valuename` перед тем как бежать ERDDAP™ . Например, использовать ` ERDDAP Базовый URL` преобладает над ` <baseUrl> ` ценность.
Это может быть удобно при развертывании ERDDAP™ с контейнером, таким как Docker, вы можете установить стандартные настройки в setup.xml
Затем поставьте специальные настройки через переменные среды. Если вы предоставляете секретную информацию ERDDAP™ С помощью этого метода,
Убедитесь, что информация останется секретной. ERDDAP™ считывает переменные среды только один раз на стартап;
в первую секунду запуска, поэтому один из способов использовать это: установить переменные среды, начать ERDDAP ,
Подождите, пока ERDDAP™ Запускается, затем отключаются переменные среды.

###  datasets.xml  {#datasetsxml} 

* Читайте комментарии в [ **Работая с datasets.xml Файл** ](/docs/server-admin/datasets) . Позже, когда ты получишь ERDDAP™ бегать
впервые (Обычно только с наборами данных по умолчанию) Вы будете изменять XML в `Tomcat/content/erddap/ datasets.xml ` 
указать все наборы данных, которые вы хотите ERDDAP™ служить. Именно здесь вы проведете большую часть своего времени.
При установлении ERDDAP™ А потом, сохраняя свой ERDDAP™ .

Вы можете увидеть пример [ datasets.xml На GitHub](https://github.com/ERDDAP/erddap/blob/main/development/jetty/config/datasets.xml) .
     
*  (маловероятно) Сейчас или (немного вероятнее) Если вы хотите изменить CSS-файл erddap, копируйте
   `tomcat/content/erddap/images/erddapStart2.css` то `Tomcat/content/erddap/images/erddap2.css` А затем внести в него изменения.
Изменения в `erddap2.css` Возникает только тогда, когда ERDDAP™ Перезапускается и часто требует от пользователя очистить кэшированные файлы браузера.
     
 ERDDAP™ не будет работать правильно, если setup.xml или datasets.xml Файл не является хорошо сформированным XML-файлом. После редактирования этих файлов,
Это хорошая идея, чтобы проверить, что результат хорошо сформирован XML, вставив текст XML в XML-проверку. [xmlvalidation](https://www.xmlvalidation.com/) .
     
### Установите erddap. военный файл{#install-the-erddapwar-file} 

4. Linux, Mac и Windows, __download [erddap.war](https://github.com/ERDDAP/erddap/releases/download/v2.28.1/erddap.war) ___ в `Tomcat/webapps` :

__Версия 2.28.1, 622 676 238 байт, MD5=48b4226045f950c8a8d69ef9521b9bc9, от 2025-09-05__

Военный файл большой, потому что он содержит данные о береговой линии, границе и высоте высокого разрешения, необходимые для создания карт.

Также доступны некоторые предыдущие версии.

   *  [2.17](https://github.com/ERDDAP/erddap/releases/download/v2.17/erddap.war)   (551 068 245 байт, MD5=5FEA912B5D42E50EAB9591F773EA848D, от 2022-02-16) 
   *  [2.18](https://github.com/ERDDAP/erddap/releases/download/v2.18/erddap.war)   (551 069 844 байт, MD5=461325E97E7577EC671DD50246CCFB8B, от 2022-02-23) 
   *  [2.21](https://github.com/ERDDAP/erddap/releases/download/v2.21/erddap.war)   (568 644 411 байт, MD5=F2CFF805893146E932E498FDDBD519B6, от 2022-10-09) 
   *  [2.22](https://github.com/ERDDAP/erddap/releases/download/v2.22/erddap.war)   (567 742 765 байт, MD5=2B33354F633294213AE2AFDDCF4DA6D0, от 2022-12-08) 
   *  [2.23](https://github.com/ERDDAP/erddap/releases/download/v2.23/erddap.war)   (572 124 953 байт, MD5=D843A043C506725EBD6F8EFDCCA8FD5F, от 2023-03-03) 
   *  [2.24](https://github.com/ERDDAP/erddap/releases/download/v2.24/erddap.war)   (568 748 187 байт, MD5=970fbee172e28b0b8a07756eecbc898e, от 2024-06-07) 
   *  [2.25](https://github.com/ERDDAP/erddap/releases/download/v2.25.1/erddap.war)   (592 292 039 байт, MD5=652AFC9D1421F00B5F789DA2C4732D4C, от 2024-11-07) 
   *  [2.26](https://github.com/ERDDAP/erddap/releases/download/v2.26.0/erddap.war)   (607 404 032 байт, MD5=99a725108b37708e5420986c1616a119, от 2025-03-31) 
   *  [2.27.0](https://github.com/ERDDAP/erddap/releases/download/v2.27.0/erddap.war)   (620 554 403 байт, MD5=3b2086c659eee4145ca2dff447bf4ef7, от 2025-06-11) 

### Настройка прокси (развертывание конкретных)  {#proxy} 

 ERDDAP™ Обычно развертывается за обратным прокси-сервером, чтобы его можно было обслуживать на стандартных HTTP-портах. (80 и 443) .
Прекращение SSL / TLS часто происходит на прокси-слое веб-сервера. Специфика зависит от требований каждого развертывания.

#### Апач{#apache} 

1. Убедитесь, что `mod_proxy` и `mod_proxy_ http ` Загружаются:

```
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so
```

2. Изменить существующий ` <VirtualHost> ` тег (Если есть один) или добавить в конце файла:
```
<VirtualHost *:80>
   ServerName YourDomain.org
   ProxyRequests Off
   ProxyPreserveHost On
   ProxyPass /erddap http://localhost:8080/erddap
   ProxyPassReverse /erddap http://localhost:8080/erddap
</VirtualHost>
```

Если ERDDAP™ На другом пути, кроме `/erddap` Также установить `X-Forwarded-Prefix` заголовок к
Сегмент пути _before_ `/erddap` . Этот параметр будет уместным для ERDDAP™ служить в
 `/subpath/erddap` :

```
RequestHeader set X-Forwarded-Prefix /subpath
```

3. Перезапуск Apache: `/usr/sbin/apachectl -к грациозный`   (Но иногда он находится в другом каталоге.) .
         
#### NGINX{#nginx} 

В файле конфигурирования nginx установите эти заголовки:
```
proxy_set_header Host              $http_host;
proxy_set_header X-Real-IP         $remote_addr;
proxy_set_header REMOTE_ADDR       $remote_addr;
proxy_set_header HTTP_CLIENT_IP    $remote_addr;
proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
```

Если ERDDAP™ На другом пути, кроме `/erddap` Также установить `X-Forwarded-Prefix` заголовок к
Сегмент пути _before_ `/erddap` . Этот параметр будет уместным для ERDDAP™ служить в
 `/subpath/erddap` :

```
proxy_set_header X-Forwarded-Prefix /subpath
```


Чтобы получить NGINX и ERDDAP™ правильно работать с https , вы должны поместить следующий фрагмент внутри Tomcat server.xml ` <Host> ` Блок:
```
<Valve className="org.apache.catalina.valves.RemoteIpValve"
  remoteIpHeader="X-Forwarded-For"
  protocolHeader="X-Forwarded-Proto"
  protocolHeaderHttpsValue="https" />
```
     
### Начать Tomcat{#start-tomcat} 

*  (Я не рекомендую использовать Tomcat Web Application Manager. Если вы не полностью отключите и не запустите Tomcat, рано или поздно у вас будут проблемы с памятью PermGen.) 
*  (В Linux или Mac OS, если вы создали специального пользователя для запуска Tomcat, например, Tomcat, не забудьте выполнить следующие действия в качестве этого пользователя.) 
* Если Tomcat уже работает, закройте Tomcat. (Linux или Mac OS)   `Tomcat/bin/shutdown.sh` 
или (В Windows)   `Tomcat\bin shutdown.bat ` 

Linux, использовать `ps -ef | греп томкат` До и после `Отключение. рубить` Чтобы убедиться, что процесс томата остановился.
Процесс должен быть указан до отключения и в конечном итоге не указан после отключения.
Это может занять минуту или две для ERDDAP™ полностью закрыться. Будь терпелив. Или если кажется, что он не остановится сам по себе, используйте:
   `Убить -9 <processID> ` 
* Начните с Tomcat (Linux или Mac OS)   `Tomcat/bin/startup.sh` или (В Windows)   `Tomcat\bin\\startup.bat` 

## это ERDDAP™ бегать?{#is-erddap-running} 

Используйте браузер, чтобы попытаться просмотретьhttp://www.YourServer.org/erddap/status.html.
 ERDDAP™ Запускается без загрузки наборов данных. Наборы данных загружаются в фоновый поток и поэтому становятся доступными один за другим.

### устранение неполадок{#troubleshooting} 

* Когда приходит запрос от пользователя, он переходит в Apache. (на компьютерах Linux и Mac OS) Потом Томкэт, потом ERDDAP™ .
* Вы можете увидеть, что происходит с Apache. (и связанных с ними ошибок) в файлах журнала Apache.
*    [Ты](/docs/server-admin/additional-information#tomcat-logs) Посмотрим, что будет с Tomcat (и связанных с ними ошибок) 
в файлах журнала Tomcat ( `tomcat/logs/catalina.out` и другие файлы в этом каталоге) .
*    [Ты](/docs/server-admin/additional-information#log) Увидеть, что приходит ERDDAP диагностические сообщения от ERDDAP ,
Ошибочные сообщения от ERDDAP в ERDDAP™   ` <bigParentDirectory> /logs/log.txt` Файл.
* Tomcat не запускается ERDDAP™ Пока Томкэт не получит запрос ERDDAP™ . Так что вы можете увидеть в файлах журнала Tomcat, если это
начинать ERDDAP™ или если есть сообщение об ошибке, связанное с этой попыткой.
* Когда ERDDAP™ Начинается, переименовывает старое ERDDAP™ log.txt файл ( `logArchivedAt <CurrentTime> .txt` ) Создает новый файл log.txt.
Так что если `log.txt` Файл старый, это признак того, что ERDDAP™ Недавно не перезапустили. ERDDAP™ Запись log info в буфер
и только периодически записывает буфер в файл журнала, но вы можете заставить ERDDAP™ Записать буфер в файл журнала, посетив
     ` /erddap/status.html ` .

### Проблема: старая версия Java  {#trouble-old-version-of-java} 

Если вы используете версию Java Это слишком старо для ERDDAP , ERDDAP™ Вы не запустите и увидите сообщение об ошибке в файле журнала Tomcat.

```
Exception in thread "main" java.lang.UnsupportedClassVersionError:
_some/class/name_: Unsupported major.minor version _someNumber_
```

Решение заключается в обновлении до последней версии Java И убедись, что Томкэт использует его.

### Проблема: медленный запуск в первый раз{#trouble-slow-startup-first-time} 

Tomcat должен сделать много работы в первый раз, когда приложение ERDDAP™ Начинается; в частности, он должен распаковать `erddap.war` файл
 (который похож на .zip файл) . На некоторых серверах первая попытка просмотра ERDDAP™ ларьки (30 секунд?) Пока эта работа не будет завершена.
На других серверах первая попытка сразу же провалится. Но если вы подождите 30 секунд и попробуете еще раз, это будет иметь успех. ERDDAP™ был установлен правильно.

Для этого нет никакого решения. Именно так работает Tomcat. Но это происходит только в первый раз после установки новой версии. ERDDAP™ .

## Закрыть и перезапустить{#shut-down-and-restart} 

В будущем закрыть (и возобновить)   ERDDAP™ Видишь? [Как закрыть и перезапустить Tomcat ERDDAP ](/docs/server-admin/additional-information#shut-down-and-restart) .

## Проблемы?{#trouble} 

Проблемы с установкой Tomcat или ERDDAP™ ? Увидеть наш [Раздел о дополнительной поддержке](/docs/intro#support) .

## Уведомление по электронной почте о новых версиях ERDDAP  {#email-notification-of-new-versions-of-erddap} 

Если вы хотите получать электронное письмо каждый раз, когда новая версия ERDDAP™ Доступны или другие важные ERDDAP™ объявления,
Вы можете присоединиться к ERDDAP™ Список объявлений [здесь](https://groups.google.com/g/erddap-announce) . Этот список в среднем составляет примерно одно электронное письмо каждые три месяца.

## настраивать{#customize} 

*  [Настроить свой ERDDAP™ Чтобы подчеркнуть вашу организацию (не NOAA   ERD ) .](#customize) 
* Измените баннер, который появляется в верхней части ERDDAP™ .html страницы путем редактирования ` <startBodyHtml5> ` Тэг в твоей ` datasets.xml ` Файл.
(Если нет, скопируйте по умолчанию из ERDDAP™ ? `tomcat/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml` файл
в ` datasets.xml ` и редактировать его. Например, вы можете:
  * Используйте другое изображение (Логотип вашей организации) .
  * Измените цвет фона.
  * Переоденься. ERDDAP™ «Ваша организация» ERDDAP™ "
  * Изменить «Упрощенный доступ к научным данным» на «Упрощенный доступ к данным вашей организации».
  * Измените ссылки «Принесено вам», чтобы они были ссылками на вашу организацию и источники финансирования.
* Измените информацию на левой стороне главной страницы, отредактировав ` <theShortDescriptionHtml> ` Тэг в твоей ` datasets.xml ` Файл.
(Если нет, скопируйте по умолчанию из ERDDAP™ ? `tomcat/webapps/erddap/WEB-INF/classes/gov/noaa/pfel/erddap/util/messages.xml` файл
в ` datasets.xml ` и редактировать его. Например, вы можете:
  * Опишите, чем занимается ваша организация и/или группа.
  * Опишите, какие данные это ERDDAP™ Есть.
  * Чтобы изменить значок, который появляется на вкладках браузера, поместите favicon вашей организации. ико в `Tomcat/content/erddap/images/` .
Видишь?https://en.wikipedia.org/wiki/Favicon.
