Цей вміст ґрунтується на [повідомлення від Roy Mendelssohn до ERDDAP група користувачів](https://groups.google.com/g/erddap/c/zZUt6PKfkoI/m/expZ3UkkBAAJ) й

Останнім часом ми отримали ряд запитів, які шукають допомогу з доступу до файлів на AWS S3 в ERDDAP™ й Перший, ERDDAP™ версія 2.29 буде покращено доступ S3, який повинен працювати з не-AWS об'єктами. (Дякую&#33;) й Але я раніше згадав про використання системи FUSE, щоб зробити магазин S3 з'явився як файлова система на вашому сервері або VM.

Один із способів зробити це за допомогою «rclone». (https://rclone.org/) . rclone працює на багатьох різних S3-системах, і має безліч різних налаштувань для оптимізації продуктивності, включаючи налаштування розміру кешу, що сподівається, може згасити деякі швидкості штрафу від запуску FUSE. Перевага використання рклону з ERDDAP ТМ є те, що rclone ручить всю взаємодію з S3, тому типи даних, такі як EDDGrid ВідNcFiles можна використовувати безпосередньо, якщо є локальні файли. Це означає, що вам потрібно лише дізнатися, як встановити rclone для доступу до вашого магазину об'єктів, а інші - це просто нормальні налаштування типу Linux.

Тепер я б відповіла, якщо я просто пішов на це, і не даю приклад. У наступній я збираюся анонімно монтувати NOAA Goes17 даних, які є на публічному доступному магазині AWS S3 на одному з наших серверів Ubuntu, в початковій налаштуваннях процес rclone буде працювати в передовій частині, щоб зробити його простіше перевірити, що все працює, а потім я буду обговорювати, як перетворити ii в службу, що працює на фоні. Зверніть увагу, що в якому нижче, кеш встановлюється до 1 Гб. Продуктивність може бути добре покращений, роблячи кеш набагато більшим, сказати 5GB-10GB або навіть більше. Також налаштування є моїм припущенням, що може оптимізувати продуктивність, але не може бути оптимальним для ERDDAP™ й


1. Встановлення необхідного програмного забезпечення:
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

sudo apt оновлення
sudo apt встановити rclone fuse3 -й

2. Створення анонімного пульта S3
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

JavaScript licenses API Веб-сайт Go1.13.8
провайдер AWS \\
область us-east-1 \\
Місцезнаходження_навчання нас-схід-1 \\
env_auth false \\
анонімна правда

3. Тестування.
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

rclone lsd goes17:noaa-goes17 | Головна

4. Створення точки кріплення для даних
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

sudo mkdir -p /mnt/goes17
sudo chown $USER:$USER /mnt /goes17

5. Встановити дані. (Зауважте, що цей процес працює на передмісті, тому він покаже деякий вихід і сидить там) 
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

rclone -vv кріплення йде17:noaa-goes17 /mnt/goes17 \\
--read-only \\
--vfs-cache-mode повний \\
--vfs-cache-max-size 1G \\
--vfs-cache-poll-interval 1м \\
--vfs-read-chunk-size 64М \\
--vfs-read-chunk-size-limit 1G \\
--vfs-read-ahead 256М \\
--купе-розмір 64M \\
--dir-cache-time 24h \\
--attr-timeout 1s \\
--без моду

6. Відкрийте нову вкладку на сервері і перевірте
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

л/мnt/goes17 | Головна

7. Перевірити дані можна
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
cd/mnt/goes17/ABI-L1b-RadC/2023/010/15
пердят -час OR_ABI-L1b-RadC-M6C16_G17_s20230101536138_e20230101536138_c20230101541461 .nc 
```
netcdf OR_ABI-L1b-RadC-M6C16_G17_s20230101536138_e20230101536138_c20230101541461 {
dimensions:
y = 1500 ;
x = 2500 ;
number_of_time_bounds = 2 ;
band = 1 ;
number_of_image_bounds = 2 ;
num_star_looks = 24 ;
variables:
short Rad(y, x) ;
Rad:_FillValue = 1023s ;
Rad:long_name = "ABI L1b Radiances" ;
Rad:standard_name = "toa_outgoing_radiance_per_unit_wavenumber" ;
Rad:_Unsigned = "true" ;
Rad:sensor_band_bit_depth = 10b ;
Rad:valid_range = 0s, 1022s ;
Rad:scale_factor = 0.1760585f ;
Rad:add_offset = -5.2392f ;
Rad:units = "mW m-2 sr-1 (cm-1)-1" ;
Rad:resolution = "y: 0.000056 rad x: 0.000056 rad" ;
Rad:coordinates = "band_id band_wavelength t y x" ;
Rad:grid_mapping = "goes_imager_projection" ;
Rad:cell_methods = "t: point area: point" ;
Rad:ancillary_variables = "DQF" ;
.
.
.
.
```
В результаті було повернуто дивно швидко, зокрема, оскільки наша установка не має найшвидших труб у світі.

8. Зробіть в системний сервіс (змінювати у відповідному порядку для користувача тощо) :
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

а. Створення системного блоку:

sudo нано /etc/systemd/system/rclone-goes17.service

І введіть:

[Немає]
Опис:Рклоне кріплення для GOES17 громадського S3
Після=мережа-онлайн .tar Увійти

Послуги
Тип=прості
Користувач=ubuntu
ExecStart=/usr/bin/rclone mount goes17:noaa-goes17/mnt/goes17 \\
--read-only \\
--vfs-cache-mode повний \\
--vfs-cache-max-size 1G \\
--vfs-cache-poll-interval 1м \\
--vfs-read-chunk-size 64М \\
--vfs-read-chunk-size-limit 1G \\
--vfs-read-ahead 256М \\
--купе-розмір 64M \\
--dir-cache-time 24h \\
--attr-timeout 1s \\
--no-modtime \\
--s3-no-check-bucket
ExecStop=/bin/fusermount3 -u /mnt/goes17
Статус на сервери
РемартСец=10

[Встановити]
JavaScript licenses API Веб-сайт Go1.13.8 .tar Увійти

б. Увімкніть послугу та запустіть:

sudo системаctl daemon-reload
sudo systemctl Увімкніть --now rclone-goes17

з. Тести

системний статус rclone-goes17
л/мnt/goes17 | Головна



На жаль, це буде використовуватися людям. Ми тестуємо за допомогою Gcsfuse на Google Cloud Platform з відро, що має ієрархічний простір імен з деякими успіхами. Одна перевага рклону (крім того, він не є постачальником) є те, що він має більше налаштувань для оптимізації продуктивності. Особливо якщо ви переміщуєте локальну ERDDAP™ до хмари це може зробити перехід практично безшовним.
