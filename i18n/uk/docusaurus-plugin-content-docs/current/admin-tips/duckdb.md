Цей вміст ґрунтується на [повідомлення від Roy Mendelssohn до ERDDAP група користувачів](https://groups.google.com/g/erddap/c/6Hl024ZGkes/m/DS5WzsydAQAJ) й

 ERDDAP™ намагається бути діагностикою про те, які формати даних використовують для своїх даних, а не намагатися працювати з форматами даних, які використовують для громад, які ми в основному обслуговуємо. Більшість і більше роботи в хмарі, і є безліч форматів даних, які люди використовують в хмарі, це буде приємно, якщо ERDDAP™ може підтримувати багато таких форматів. Алас, ERDDAP™ розвиток і обслуговування вже недооцінені, і що бажано зробити використання роботи інших для досягнення цієї мети, не маючи необхідності модифікувати ERDDAP™ й

Увійти [ДахДБ](https://duckdb.org/) і [Трино](https://trino.io/) й Обидві з них забезпечують підключення до різних форматів даних і можуть бути доступні за допомогою JDBC. У цьому записі я буде виглядати лише за допомогою DuckDB, оскільки у мене є деякі знайомства з ним, і Trino принаймні до мого розуму, здавалося трохи складніше налаштувати, і тепер я просто хотів докази поняття. (В той час як Дам'єн Смите написав, що він був виведений, як використовувати Тріно і я зв'язався з ним і він зробив його для роботи і відправить мені ноти - так далі на це в майбутньому) й Також я все, але експерт з будь-якого з них, тому це навчання разом з мною - дозвольте мені знати, якщо ви знайдете будь-які помилки, або речі, які незрозумілі, або якщо є кращі способи зробити речі.

1. Попередня стаття:
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

Для використання DuckDB в ERDDAP™ вам потрібно встановити duckDB на комп'ютер, і встановити роз'єм DuckDB JDBC в ERDDAP™ й Інструкція по установці DuckDB саме на

https://duckdb.org/docs/installation/?version=stable&environment=cli&platform=macos&download_method=direct

Роз'єм DuckDB JDBC можна завантажити з

https://duckdb.org/docs/stable/clients/java.html

Якщо ваш томікат знаходиться в $TOMCAT_HOME, то ви хочете поставити цей файл в $TOMCAT_HOME/webapps/erddap/WEB-INF/lib.

2. Що робить цю хитрість:
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————


принаймні для DuckDB (як я сказав, що я не дивився на Тріно в будь-якій деталь)   Java За допомогою роз'єму JDBC можна лише читати дані, які зберігаються у форматі DuckDB .db. Незважаючи на те, що DuckDB є великим інструментом, що має копіювати дані до цього формату перемогти цілі, однак, DuckDB забезпечує об'єкт, який для багатьох форматів файлів він підтримує (є зростаючий список розширень) Ви можете налаштувати віртуальний файл .db, який просто читає у необхідних метаданих. Я знайшов .db, який створений для того, щоб бути досить малим за розміром, і забезпечує те, що з'являється швидкий доступ. Цікава замітка, що на відміну від більшості баз даних (і в тому числі Трино) , з качкою DB ви не маєте програми, яка постійно працює на фоні, тому повинні бути деякі лаг у доступі через стартап, але як я сказав в мої невеликі тести доступ здається швидко.


3. Простий приклад:
————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————

Щоб розпочати, я побачу, як це зробити з файлом .csv. Правильно, це не те, що цікавий випадок використання ERDDAP™ вже ручає файли .csv досить добре, тому нічого не набуває в цьому сенсі, але текстовий файл легше працювати з і для видалення, що відбувається, і як я дізнався, що це було моє життя простіше. Нижче я побачу більше цікавих випадків, коли ми бачимо, що потрібно.

Файл, який я працюю з "detects.csv", який є файлом 305MB для виявлення міток датчиками. Перший крок - створити файл .db, який вказує на цей файл (в цьому і що випливає з зручності, я завжди припустимо, що ви працюєте на рівні, потрібно, щоб я не даю повних доріжок - на практиці ви повинні мати) :

```
duckdb detects.db <<EOF
CREATE VIEW detects_table AS
SELECT *
FROM read_csv_auto(
'detects.csv',
header=true,
sample_size=2147483647 -- scan whole file for schema (optional)
);
EOF
```

Файл «detects.db» - 268KB за розміром. Ми можемо перевірити, що це насправді працює:

```
duckdb detects.db
DuckDB v1.3.1 (Ossivalis) 2063dda3e6
Enter ".help" for usage hints.
D SHOW TABLES;
┌───────────────┐
│ name │
│ varchar │
├───────────────┤
│ detects_table │
└───────────────┘
D SELECT * FROM detects_table LIMIT 5;
┌────────────────┬─────────┬──────────────┬───────┬──────────┬───┬──────────┬──────────────┬───────────────┬─────────┐
│ Study_ID │ TagCode │ DateTime_PST │ recv │ location │ … │ tag_life │ Rel_latitude │ Rel_longitude │ time │
│ varchar │ varchar │ timestamp │ int64 │ varchar │ │ int64 │ double │ double │ varchar │
├────────────────┼─────────┼──────────────┼───────┼──────────┼───┼──────────┼──────────────┼───────────────┼─────────┤
│ ButteSink_2024 │ 1B76 │ NULL │ NULL │ NULL │ … │ 52 │ 39.32663 │ -121.8847 │ -08 │
│ ButteSink_2024 │ 1B94 │ NULL │ NULL │ NULL │ … │ 52 │ 39.32663 │ -121.8847 │ -08 │
│ ButteSink_2024 │ 1BA5 │ NULL │ NULL │ NULL │ … │ 52 │ 39.35858 │ -121.8943 │ -08 │
│ ButteSink_2024 │ 1C55 │ NULL │ NULL │ NULL │ … │ 52 │ 39.33546 │ -121.8923 │ -08 │
│ ButteSink_2024 │ 1C95 │ NULL │ NULL │ NULL │ … │ 52 │ 39.33546 │ -121.8923 │ -08 │
├────────────────┴─────────┴──────────────┴───────┴──────────┴───┴──────────┴──────────────┴───────────────┴─────────┤
│ 5 rows 18 columns (9 shown) │
└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

і розмір виявів. db не змінився від виконання цієї операції. Так завершальний крок для підключення цього ERDDAP™ , Я покажу тільки необхідну частину для підключення до файлу, не всі змінні дані:

```
<dataset type="EDDTableFromDatabase" datasetID="duckdb_test" active="true">
<!-- JDBC Connection Details -->
<sourceUrl>jdbc:duckdb:detects.db</sourceUrl>
<driverName>org.duckdb.DuckDBDriver</driverName>
<catalogName></catalogName>
<schemaName></schemaName>
<tableName>detects_table</tableName>
<columnNameQuotes></columnNameQuotes>
>
```

І це датасет в ERDDAP™ на моєму ноутбуці за допомогою роз'єму DuckDB:
