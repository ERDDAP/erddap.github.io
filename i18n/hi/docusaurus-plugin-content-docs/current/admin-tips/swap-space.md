यह सामग्री एक पर आधारित है [Roy Mendelssohn से संदेश ERDDAP उपयोगकर्ता समूह](https://groups.google.com/g/erddap/c/1U0OByOasu4/m/JM39reEsBAAJ) ।

कई मदद अनुरोधों में हम स्मृति उपयोग के साथ समस्याओं को शामिल करते हैं ERDDAP™ । इसमें से कुछ स्मृति प्रबंधन में परिवर्तन से आता है Java लिनक्स ओएस मेमोरी प्रबंधन के साथ भी बातचीत करते हैं। शुरू करना Java 17, Java हेप सेटिंग्स में क्या डाला गया है, इसकी तुलना में अधिक मेमोरी का उपयोग करता है। आप इसे देख सकते हैं यदि आप अपनी हेप सेटिंग्स को देखते हैं और फिर अनुप्रयोगों के मेमोरी उपयोग की जांच के लिए शीर्ष, htop या btop जैसे कमांड का उपयोग करते हैं। उदाहरण के लिए, हमारे भारी उपयोग ERDDAP™ 21GB में हेप स्पेस सेट है, लेकिन वास्तव में मेमोरी का उपयोग 28GB-30GB तक चला सकता है, कभी-कभी अधिक होता है। यह मान स्पाइक कर सकता है यदि सिस्टम के लिए बहुत सारे एक साथ बड़े अनुरोध हैं।

अधिकांश लिनक्स सिस्टम पर, एक बार मेमोरी का उपयोग लगभग 50% से अधिक हो जाता है, ओएस मेमोरी को स्वैप करना शुरू कर देगा। इसके अलावा, अधिकांश प्रणालियों के लिए स्वैप स्पेस बिल्कुल आवश्यक होने तक एकत्र नहीं किया जाता है, जिसके लिए ERDDAP™ बहुत देर है, और कारण हो सकता है ERDDAP™ फ्रीज करने के लिए। और स्वैप अंतरिक्ष धीमी है, जो बड़े पैमाने पर है datasets.xml प्रमुख अद्यतनों को पूरा नहीं करने का कारण बन सकता है, जो तब समस्याओं को हल करता है।

क्या आप इस बारे में क्या कर सकते हैं? सबसे पहले, सही स्मृति उपयोग या आपके सिस्टम को ढूंढें, और पर्याप्त रैम है ताकि मेमोरी का उपयोग 50% से अधिक न हो। लेकिन दो सेटिंग्स भी हैं जो इस व्यवहार को बदल सकती हैं, vm.swappiness। vm.vfs_cache_pressure.

vm.swappiness नियंत्रण कैसे आक्रामक रूप से लिनक्स कर्नेल स्वैप स्पेस का उपयोग करता है। आप अपने वर्तमान मूल्य के साथ देख सकते हैं:

> cat /proc/sys/vm/swappiness
>
• डिफ़ॉल्ट आम तौर पर 60 है (0 से 100 तक के पैमाने पर) ।
• निम्न मान प्रणाली को स्वैप करने की संभावना कम करते हैं।
• 10 या 1 का मूल्य अक्सर बहुत सारे रैम वाले सिस्टम के लिए प्रयोग किया जाता है।


फिर से शुरू होने तक मूल्य को बदलने के लिए, 10 से कहते हैं:

> sudo sysctl vm.swappiness=10
>

और स्थायी रूप से बदलने के लिए:

> sudo nano /etc/sysctl.conf
>

और vm.swappiness के लिए मूल्य संपादित करें। फिर परिवर्तन लागू करने के लिए:

> sudo sysctl -p
>

vm.vfs_cache_pressure. सिस्टम को बताता है कि स्मृति को पुनः प्राप्त करने में आक्रामक कैसे होता है। उच्च मूल्य। (100 या अधिक) सिस्टम को अधिक आक्रामक होने के लिए कहें, वर्तमान मूल्य की जांच करने के लिए:

> cat /proc/sys/vm/vfs_cache_pressure
>

अगले रिबूट तक मूल्य बदलने के लिए:

> sudo sysctl vm.vfs_cache_pressure=150
>

स्थायी रूप से मूल्य बदलने के लिए:

> sudo nano /etc/sysctl.conf
>

और फिर जोड़ने या अद्यतन लाइन:

> vm.vfs_cache_pressure = 100
>

और फिर परिवर्तन लागू करें:

> sudo sysctl -p
>


यदि आप अपने स्वैप अंतरिक्ष उपयोग की निगरानी करते हैं तो आप क्या कर सकते हैं? वहाँ एक आदेश है कि अंतरिक्ष स्वैप खाली होगा और स्मृति के लिए सामग्री ले जाएँ। इसका उपयोग करने से पहले, आपको कुछ ऐसा करने की आवश्यकता है जो उपलब्ध स्मृति स्वैप उपयोग से बड़ा है। मैं उपलब्ध स्मृति कहते हैं क्योंकि लिनक्स सिस्टम में भारी डिस्क उपयोग के साथ "cached स्मृति" काफी अधिक हो सकता है, इसलिए "मुक्त स्मृति" बहुत कम होने के रूप में दिखाई देगा, लेकिन अगर इस तरह के कमांड के लिए आवश्यक हो तो "चेक मेमोरी" उपलब्ध कराया जाएगा।

> sudo swapoff -a && sudo swapon -a
>

बस कुछ होना इसके बाद भी मैं कचरा संग्रह को मजबूर करना चाहता हूं:

> sudo jcmd $(pgrep java) GC.run
>

फिर मुझे आशा है कि कुछ लोग इस जानकारी को उपयोगी पाते हैं। हम बनाना चाहते हैं ERDDAP™ जितना संभव हो उतना मजबूत, और जितना संभव हो उतना सहज रूप से काम करने के लिए वास्तव में लोग कैसे काम करते हैं।
