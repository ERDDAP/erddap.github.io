"use strict";(globalThis.webpackChunkdocumentation=globalThis.webpackChunkdocumentation||[]).push([[9383],{28453(t,e,i){i.d(e,{R:()=>l,x:()=>r});var n=i(96540);const a={},s=n.createContext(a);function l(t){const e=n.useContext(s);return n.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function r(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(a):t.components||a:l(t.components),n.createElement(s.Provider,{value:e},t.children)}},49644(t,e,i){i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"server-admin/mqtt-integration","title":"ERDDAP MQTT-integraatio","description":"ERDDAP MQTT-protokolla tukee nyt reaaliaikaisten tietojen hy\xf6dynt\xe4mist\xe4 ja ilmoittamista. Toiminnallisuus perustuu avoimeen l\xe4hdekoodiin  HiveMQ MQTT asiakas  ja  HiveMQ Yhteis\xf6  V\xe4litt\xe4j\xe4kirjastot.","source":"@site/i18n/fi/docusaurus-plugin-content-docs/current/server-admin/mqtt-integration.md","sourceDirName":"server-admin","slug":"/server-admin/mqtt-integration","permalink":"/fi/docs/server-admin/mqtt-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/erddap/erddap.github.io/tree/main/docs/server-admin/mqtt-integration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docSidebar","previous":{"title":"Lippujen ominaisuudet","permalink":"/fi/docs/server-admin/feature-flags"},"next":{"title":"Contributing","permalink":"/fi/docs/category/contributing"}}');var a=i(74848),s=i(28453);const l={},r="ERDDAP MQTT-integraatio",o={},d=[{value:"ERDDAP MQTT-asiakkaana",id:"erddap-mqtt-asiakkaana",level:2},{value:"Konfiguraatio: <code>EDDTableFromMqtt</code>",id:"konfiguraatio-eddtablefrommqtt",level:2},{value:"ERDDAP MQTT-v\xe4litt\xe4j\xe4n\xe4",id:"erddap-mqtt-v\xe4litt\xe4j\xe4n\xe4",level:2},{value:"Sulautettu v\xe4litt\xe4j\xe4",id:"sulautettu-v\xe4litt\xe4j\xe4",level:2},{value:"Broker Configuration &amp; Data Directorys N\xe4yt\xe4 tarkat tiedot",id:"broker-configuration--data-directorys-n\xe4yt\xe4-tarkat-tiedot",level:2},{value:"K\xe4ytt\xf6tapaus 1: Tietojen yhdist\xe4minen MQTT-asiakkailta",id:"k\xe4ytt\xf6tapaus-1-tietojen-yhdist\xe4minen-mqtt-asiakkailta",level:2},{value:"Tapaus 2: Tietojen muutosilmoitusten julkaiseminen",id:"tapaus-2-tietojen-muutosilmoitusten-julkaiseminen",level:2},{value:"Ymp\xe4rist\xf6muuttujat <code>datasets.xml</code>",id:"ymp\xe4rist\xf6muuttujat-datasetsxml",level:2}];function c(t){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"erddap-mqtt-integraatio",children:"ERDDAP MQTT-integraatio"})}),"\n",(0,a.jsxs)(e.p,{children:["ERDDAP MQTT-protokolla tukee nyt reaaliaikaisten tietojen hy\xf6dynt\xe4mist\xe4 ja ilmoittamista. Toiminnallisuus perustuu avoimeen l\xe4hdekoodiin ",(0,a.jsxs)(e.a,{href:"https://github.com/hivemq/hivemq-mqtt-client",children:[" ",(0,a.jsx)(e.strong,{children:"HiveMQ MQTT asiakas"})," "]})," ja ",(0,a.jsxs)(e.a,{href:"https://github.com/hivemq/hivemq-community-edition",children:[" ",(0,a.jsx)(e.strong,{children:"HiveMQ Yhteis\xf6"})," "]})," V\xe4litt\xe4j\xe4kirjastot."]}),"\n",(0,a.jsxs)(e.p,{children:["ERDDAP MQTT",":t","\xe4 voidaan k\xe4ytt\xe4\xe4 kahdella p\xe4\xe4asiallisella tavalla:"]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"MQTT-asiakkaana:"}),"    ERDDAP voi tilata aiheita olemassa olevassa MQTT-v\xe4litt\xe4j\xe4ss\xe4 hy\xf6dynt\xe4m\xe4\xe4n tietoja ja luoda reaaliaikaisia tietoaineistoja."]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"MQTT-v\xe4litt\xe4j\xe4n\xe4:"}),"    ERDDAP voi is\xe4nn\xf6id\xe4 omaa upotettua MQTT-v\xe4litt\xe4j\xe4\xe4, jonka avulla ulkopuoliset asiakkaat voivat julkaista tietoja suoraan sille."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"erddap-mqtt-asiakkaana",children:"ERDDAP MQTT-asiakkaana"}),"\n",(0,a.jsxs)(e.p,{children:["ERDDAP voi toimia MQTT-asiakkaana tilaamaan aiheita ulkoisella tai omalla upotetulla MQTT-v\xe4litt\xe4j\xe4ll\xe4. T\xe4m\xe4 saavutetaan k\xe4ytt\xe4m\xe4ll\xe4 uutta ",(0,a.jsx)(e.code,{children:"EDDTableFromMqtt"})," tietotyyppi, joka toimii samalla tavalla kuin nykyinen ",(0,a.jsxs)(e.a,{href:"/docs/server-admin/datasets#eddtablefromhttpget",children:[" ",(0,a.jsx)(e.code,{children:"EdDTableFromHttpGet"})," "]})," Dataa."]}),"\n",(0,a.jsxs)(e.p,{children:["T\xe4ll\xe4 hetkell\xe4 asiakaspalvelu tukee vain ",(0,a.jsx)(e.strong,{children:"subscribing"})," aiheita."]}),"\n",(0,a.jsxs)(e.h2,{id:"konfiguraatio-eddtablefrommqtt",children:["Konfiguraatio: ",(0,a.jsx)(e.code,{children:"EDDTableFromMqtt"})]}),"\n",(0,a.jsxs)(e.p,{children:["M\xe4\xe4ritt\xe4\xe4 tietoaineiston tilaamaan MQTT-v\xe4litt\xe4j\xe4, m\xe4\xe4ritt\xe4\xe4 tyypin tietoaineisto. ",(0,a.jsx)(e.code,{children:"EDDTableFromMqtt"})," sinun sis\xe4ll\xe4si ",(0,a.jsx)(e.code,{children:"datasets.xml"})," tiedosto. Seuraavat konfiguraatiot ovat saatavilla ",(0,a.jsx)(e.code,{children:"<dataset>"})," Blokki:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"\x3c!-- Example configuration for an EDDTableFromMqtt dataset in datasets.xml --\x3e\n<dataset type=\"EDDTableFromMqtt\" datasetID=\"mqtt_realtime_data\" active=\"true\">\n\n    \x3c!-- The hostname or IP address of the MQTT broker. --\x3e\n    <serverHost>broker.example.com</serverHost>\n\n    \x3c!-- The port number of the MQTT broker. --\x3e\n    <serverPort>1883</serverPort>\n\n    \x3c!-- A unique identifier for this MQTT client. --\x3e\n    <clientId>erddap-subscriber-1</clientId>\n\n    \x3c!-- The username for broker authentication (optional). --\x3e\n    <username>user</username>\n\n    \x3c!-- The password for broker authentication (optional). --\x3e\n    <password>secret</password>\n\n    \x3c!-- A comma-separated list of MQTT topics to subscribe to. --\x3e\n    <topics>sensor/+/data, another/topic</topics>\n\n    \x3c!-- Set to 'true' to use a secure SSL/TLS connection. Default is 'false'. --\x3e\n    <useSsl>false</useSsl>\n\n    \x3c!-- The session expiry interval in seconds. --\x3e\n    <sessionExpiryInterval>3600</sessionExpiryInterval>\n\n    \x3c!-- The connection timeout in seconds. --\x3e\n    <connectionTimeout>10</connectionTimeout>\n\n    \x3c!-- Set to 'true' to enable automatic reconnection. Default is 'true'. --\x3e\n    <automaticReconnect>true</automaticReconnect>\n\n</dataset>\n"})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"erddap-mqtt-v\xe4litt\xe4j\xe4n\xe4",children:"ERDDAP MQTT-v\xe4litt\xe4j\xe4n\xe4"}),"\n",(0,a.jsx)(e.p,{children:"ERDDAP Voit k\xe4ytt\xe4\xe4 upotettua MQTT-v\xe4litt\xe4j\xe4\xe4, joka palvelee kahta p\xe4\xe4tarkoitusta:"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Datan ingesointi:"})," Saadakseen ulkoisten MQTT-asiakkaiden julkaisemia tietoja reaaliaikaisten tietoaineistojen luomiseksi."]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Ilmoitukset:"})," julkaista ilmoituksia tietoaineiston muutoksista."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"sulautettu-v\xe4litt\xe4j\xe4",children:"Sulautettu v\xe4litt\xe4j\xe4"}),"\n",(0,a.jsxs)(e.p,{children:["Sulautettu MQTT-v\xe4litt\xe4j\xe4 on pois k\xe4yt\xf6st\xe4 oletusarvoisesti. Sen mahdollistamiseksi lis\xe4\xe4 seuraava lippu ",(0,a.jsx)(e.code,{children:"Asennus.xml"})," :"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"\x3c!-- Enables the embedded HiveMQ broker. Default is 'false'. --\x3e   <enableMqttBroker> Todellista </enableMqttBroker>"})}),"\n",(0,a.jsx)(e.h2,{id:"broker-configuration--data-directorys-n\xe4yt\xe4-tarkat-tiedot",children:"Broker Configuration & Data Directorys N\xe4yt\xe4 tarkat tiedot"}),"\n",(0,a.jsxs)(e.p,{children:["Voit m\xe4\xe4ritt\xe4\xe4 r\xe4\xe4t\xe4l\xf6ityj\xe4 hakemistoja v\xe4litt\xe4j\xe4n konfigurointiin ja tietotiedostoihin ",(0,a.jsx)(e.code,{children:"Asennus.xml"})," . Jos ne ovat tyhj\xe4t, ERDDAP k\xe4ytt\xe4\xe4 HiveMQ-kirjaston m\xe4\xe4ritt\xe4mi\xe4 oletushakemistoja. Lis\xe4tietoja, mukaan lukien kirjautuminen ja laajennukset, voit tutustua virallisiin ",(0,a.jsxs)(e.a,{href:"https://github.com/hivemq/hivemq-community-edition/wiki",children:[" ",(0,a.jsx)(e.strong,{children:"HiveMQ Community Wiki"})," "]})," ."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"\x3c!-- The parent directory for all MQTT-related files. --\x3e\n<bigParentDirectory>/opt/erddap/mqtt/</bigParentDirectory>\n\n\x3c!-- The path to the embedded MQTT broker's configuration folder. --\x3e\n<mqttConfigFolder>/opt/erddap/mqtt/conf/</mqttConfigFolder>\n\n\x3c!-- The path to the embedded MQTT broker's data folder. --\x3e\n<mqttDataFolder>/opt/erddap/mqtt/data/</mqttDataFolder>\n"})}),"\n",(0,a.jsx)(e.h2,{id:"k\xe4ytt\xf6tapaus-1-tietojen-yhdist\xe4minen-mqtt-asiakkailta",children:"K\xe4ytt\xf6tapaus 1: Tietojen yhdist\xe4minen MQTT-asiakkailta"}),"\n",(0,a.jsxs)(e.p,{children:["Reaaliaikaisen tietoaineiston rakentaminen sulautetun v\xe4litt\xe4j\xe4n avulla voit m\xe4\xe4ritt\xe4\xe4 ",(0,a.jsx)(e.code,{children:"EDDTableFromMqtt"})," Data (Kuten edell\xe4 on kuvattu) ",(0,a.jsx)(e.em,{children:"sama"})," ERDDAP muodostaa yhteyden omaan paikalliseen v\xe4litt\xe4j\xe4\xe4ns\xe4. Ulkopuoliset MQTT-asiakkaat voivat julkaista tietoja t\xe4h\xe4n ERDDAP v\xe4litt\xe4j\xe4, jonka ",(0,a.jsx)(e.code,{children:"EDDTableFromMqtt"})," Tiedot merkitsev\xe4t ja nielev\xe4t."]}),"\n",(0,a.jsx)(e.h2,{id:"tapaus-2-tietojen-muutosilmoitusten-julkaiseminen",children:"Tapaus 2: Tietojen muutosilmoitusten julkaiseminen"}),"\n",(0,a.jsxs)(e.p,{children:["ERDDAP voidaan m\xe4\xe4ritt\xe4\xe4 julkaisemaan ilmoituksia tietoaineiston muutoksista (esim. p\xe4ivitykset tai lataukset) aiheena MQTT-v\xe4litt\xe4j\xe4. Varmista ensin, ett\xe4 v\xe4litt\xe4j\xe4 on k\xe4yt\xf6ss\xe4 tai ulkoinen on k\xe4ytett\xe4viss\xe4. Ota sitten k\xe4ytt\xf6\xf6n ilmoitusominaisuus ",(0,a.jsx)(e.code,{children:"Asennus.xml"})," :"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"\x3c!-- Set to 'true' to publish dataset change notifications via MQTT. Default is 'false'. --\x3e   <publishMqttNotif> Todellista </publishMqttNotif>"})}),"\n",(0,a.jsxs)(e.p,{children:["Kun t\xe4m\xe4 ominaisuus otetaan k\xe4ytt\xf6\xf6n, ERDDAP k\xe4ytt\xe4\xe4 sis\xe4ist\xe4 MQTT-asiakasta viestien julkaisemiseen. T\xe4m\xe4n asiakkaan yhteysasetukset voidaan mukauttaa ",(0,a.jsx)(e.code,{children:"Asennus.xml"})," . Alla olevassa taulukossa luetellaan k\xe4ytett\xe4viss\xe4 olevat asetukset ja niiden oletusarvot."]}),"\n",(0,a.jsxs)(e.table,{children:[(0,a.jsx)(e.thead,{children:(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.th,{children:"Tag"}),(0,a.jsx)(e.th,{children:"Tyyppi"}),(0,a.jsx)(e.th,{children:"Oletusarvo"}),(0,a.jsx)(e.th,{children:"Kuvaus"})]})}),(0,a.jsxs)(e.tbody,{children:[(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttServerHost>"})}),(0,a.jsx)(e.td,{children:"string"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"Paikallinen is\xe4nt\xe4"})}),(0,a.jsx)(e.td,{children:"V\xe4litt\xe4j\xe4 julkaisee ilmoitukset."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttServerPort>"})}),(0,a.jsx)(e.td,{children:"Sis\xe4\xe4n"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"1883"})}),(0,a.jsx)(e.td,{children:"Ilmoituksen v\xe4litt\xe4j\xe4n satama."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttClientId>"})}),(0,a.jsx)(e.td,{children:"string"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"Erddap-asiakas"})}),(0,a.jsx)(e.td,{children:"Asiakastunnus ilmoituksen julkaisijalle."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttUserName>"})}),(0,a.jsx)(e.td,{children:"string"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"Erddap-k\xe4ytt\xe4j\xe4tunnus"})}),(0,a.jsx)(e.td,{children:"Ilmoituksen julkaisijan k\xe4ytt\xe4j\xe4tunnus."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttPassword>"})}),(0,a.jsx)(e.td,{children:"string"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"Erddap-password"})}),(0,a.jsx)(e.td,{children:"Ilmoituksen julkaisijan salasana."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttSsl>"})}),(0,a.jsx)(e.td,{children:"Boolee"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"V\xe4\xe4rin v\xe4\xe4r\xe4"})}),(0,a.jsx)(e.td,{children:"K\xe4yt\xe4 SSL/TLS-yhteytt\xe4 ilmoitukseen."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttKeepAlive>"})}),(0,a.jsx)(e.td,{children:"Sis\xe4\xe4n"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"60"})}),(0,a.jsx)(e.td,{children:"Jatka el\xe4m\xe4\xe4 sekunneissa."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttCleanStart>"})}),(0,a.jsx)(e.td,{children:"Boolee"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"V\xe4\xe4rin v\xe4\xe4r\xe4"})}),(0,a.jsx)(e.td,{children:"Aloita puhtaalla istunnolla (Ei pysyv\xe4\xe4 istuntoa) ."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttSessionExpiry>"})}),(0,a.jsx)(e.td,{children:"Sis\xe4\xe4n"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"10 10"})}),(0,a.jsx)(e.td,{children:"Istunnon p\xe4\xe4ttymisaika sekunneissa."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttConnectionTimeout>"})}),(0,a.jsx)(e.td,{children:"Sis\xe4\xe4n"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"10 10"})}),(0,a.jsx)(e.td,{children:"Yhteysaikataulu sekunneissa."})]}),(0,a.jsxs)(e.tr,{children:[(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"<mqttAutomaticReconnect>"})}),(0,a.jsx)(e.td,{children:"Boolee"}),(0,a.jsx)(e.td,{children:(0,a.jsx)(e.code,{children:"Todellista"})}),(0,a.jsx)(e.td,{children:"Automaattinen yhteys, jos yhteys h\xe4vi\xe4\xe4."})]})]})]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsxs)(e.h2,{id:"ymp\xe4rist\xf6muuttujat-datasetsxml",children:["Ymp\xe4rist\xf6muuttujat ",(0,a.jsx)(e.code,{children:"datasets.xml"})]}),"\n",(0,a.jsxs)(e.p,{children:["Uusi ominaisuus, joka mahdollistaa ymp\xe4rist\xf6muuttujan k\xe4yt\xf6n ",(0,a.jsx)(e.code,{children:"datasets.xml"})," . T\xe4m\xe4 on ",(0,a.jsx)(e.strong,{children:"Oletusarvon mahdollistaminen"})," ."]}),"\n",(0,a.jsxs)(e.p,{children:["Jos haluat poistaa t\xe4m\xe4n toiminnallisuuden, lis\xe4\xe4 seuraava lippu ",(0,a.jsx)(e.code,{children:"Asennus.xml"})," :"]}),"\n",(0,a.jsx)(e.p,{children:"xml"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.code,{children:"<enableEnvParsing> V\xe4\xe4rin v\xe4\xe4r\xe4 </enableEnvParsing>"})})]})}function u(t={}){const{wrapper:e}={...(0,s.R)(),...t.components};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(c,{...t})}):c(t)}}}]);